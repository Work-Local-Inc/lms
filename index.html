<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary Meta Tags -->
    <title>Work Local - AI Training for Small Business Owners | Learn Practical AI Tools</title>
    <meta name="description" content="Master AI tools for your small business with practical, hands-on courses. Learn ChatGPT, automation, and AI-powered workflows designed specifically for entrepreneurs and business owners.">
    <meta name="author" content="Dr. Claw, Work Local">
    <meta name="publish_date" property="og:publish_date" content="2025-11-18">
    <meta name="updated_date" content="2025-11-18">
    <link rel="canonical" href="https://work-local-lms.netlify.app">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/worklocal_logo_mod.png">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://work-local-lms.netlify.app">
    <meta property="og:title" content="Work Local - AI Training for Small Business Owners">
    <meta property="og:description" content="Master AI tools for your small business with practical, hands-on courses designed for entrepreneurs.">
    <meta property="og:image" content="https://work-local-lms.netlify.app/worklocal_logo_mod.png">
    <meta property="og:image:alt" content="Work Local - AI Training for Small Business">
    <meta property="og:site_name" content="Work Local">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://work-local-lms.netlify.app">
    <meta property="twitter:title" content="Work Local - AI Training for Small Business Owners">
    <meta property="twitter:description" content="Master AI tools for your small business with practical, hands-on courses designed for entrepreneurs.">
    <meta property="twitter:image" content="https://work-local-lms.netlify.app/worklocal_logo_mod.png">
    <meta property="twitter:image:alt" content="Work Local - AI Training for Small Business">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="keywords" content="AI training, small business, artificial intelligence courses, ChatGPT for business, AI automation, business AI tools, entrepreneur training">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    
    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Stripe JS -->
    <script src="https://js.stripe.com/v3/"></script>
    
    <!-- Schema.org Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "EducationalOrganization",
        "name": "Work Local",
        "description": "AI Training for Small Business Owners - Practical courses on ChatGPT, automation, and AI-powered workflows",
        "url": "https://work-local-lms.netlify.app",
        "logo": "https://work-local-lms.netlify.app/worklocal_logo_mod.png",
        "datePublished": "2025-11-18",
        "dateModified": "2025-11-18",
        "founder": {
            "@type": "Person",
            "name": "Dr. Claw",
            "jobTitle": "AI Training Specialist"
        },
        "address": {
            "@type": "PostalAddress",
            "addressCountry": "CA"
        },
        "contactPoint": {
            "@type": "ContactPoint",
            "email": "support@worklocal.ca",
            "contactType": "Customer Support"
        },
        "sameAs": [
            "https://worklocal.ca"
        ],
        "offers": {
            "@type": "AggregateOffer",
            "priceCurrency": "CAD",
            "offerCount": "Multiple courses available"
        }
    }
    </script>
    
    <!-- FAQ Schema.org Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "Do I need technical experience to learn AI tools?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "No! Our courses are specifically designed for small business owners with no technical background. We focus on practical applications and avoid complicated jargon. If you can use email and browse the web, you can learn to use AI tools for your business."
                }
            },
            {
                "@type": "Question",
                "name": "How long does it take to complete a course?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Most courses take 2-4 hours to complete, but you can learn at your own pace. Watch videos, review materials, and practice exercises whenever it fits your schedule. Many students complete courses over a weekend or in several short sessions throughout the week."
                }
            },
            {
                "@type": "Question",
                "name": "What industries are your AI courses suitable for?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "We offer specialized courses for restaurants, retail stores, healthcare providers, real estate professionals, and many other industries. Our foundational AI training applies to any small business, while industry-specific courses provide targeted strategies for your particular field."
                }
            },
            {
                "@type": "Question",
                "name": "Will I get a certificate when I complete a course?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes! Upon completing a course and passing the final assessment, you'll receive a digital certificate that demonstrates your AI competency. You can share this certificate on LinkedIn, your website, or with clients to showcase your expertise."
                }
            },
            {
                "@type": "Question",
                "name": "Are the AI tools you teach free or do they require subscriptions?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "We teach both free and paid AI tools. Many powerful AI solutions offer free tiers perfect for small businesses. When we cover premium tools, we clearly explain the costs and help you evaluate whether the investment makes sense for your specific business needs and budget."
                }
            },
            {
                "@type": "Question",
                "name": "How is AI training different from other business courses?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Traditional business courses teach concepts and strategies. Our AI training teaches you to use specific tools that immediately improve your business operations. You'll learn practical skills like automating customer responses, analyzing sales data, generating marketing content, and streamlining administrative tasks—capabilities that directly impact your bottom line."
                }
            },
            {
                "@type": "Question",
                "name": "Isn't this just another expensive course that won't help my business?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Work Local courses are designed to pay for themselves quickly. Most students implement at least one time-saving automation within the first week that saves them 2-3 hours per week. At an average business owner's time value of $50-100/hour, that's $400-1,200 in monthly value from one simple automation."
                }
            },
            {
                "@type": "Question",
                "name": "I'm already overwhelmed. Do I really have time to learn AI?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "That's exactly why you need AI! Our courses are specifically designed for busy entrepreneurs. You can complete lessons in 15-20 minute chunks, and the first automation you implement will give you back more time than you spend learning. Most students report saving 5-10 hours per week after completing just one course."
                }
            },
            {
                "@type": "Question",
                "name": "Won't AI just replace my job or make my skills obsolete?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "AI won't replace business owners—but business owners who use AI will replace those who don't. Think of AI as your tireless assistant, not your replacement. It handles repetitive tasks so you can focus on strategy, relationships, and growth."
                }
            },
            {
                "@type": "Question",
                "name": "AI seems too complicated. What if I can't understand it?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "We've taught AI to hundreds of business owners who felt the same way. Our courses assume zero technical knowledge—we literally start with 'How to copy and paste a prompt.' If you can send an email or use Facebook, you can learn AI with Work Local."
                }
            },
            {
                "@type": "Question",
                "name": "I tried ChatGPT once and it didn't work. Why would this be different?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "The difference is knowing HOW to use AI effectively. Our courses teach you proven prompts, frameworks, and workflows that actually work for real businesses. You'll learn the mistakes to avoid, the prompts that get results, and how to integrate AI into your actual business processes."
                }
            },
            {
                "@type": "Question",
                "name": "Is it safe to put my business information into AI tools?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Great question! We teach you best practices for data security and privacy. You'll learn which tools have business-grade security, how to anonymize sensitive information, and when to use enterprise vs. free versions. Security is a core part of every course."
                }
            }
        ]
    }
    </script>
    
    <style>
        :root {
            --bg-primary: #3d5a80;
            --bg-secondary: #1e2d42;
            --bg-card: rgba(255, 255, 255, 0.05);
            --bg-card-hover: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.8);
            --text-tertiary: rgba(255, 255, 255, 0.6);
            --border-color: rgba(255, 255, 255, 0.1);
            --gradient-start: #f4a261;
            --gradient-end: #e76f51;
        }

        [data-theme="light"] {
            --bg-primary: #f0f4f8;
            --bg-secondary: #ffffff;
            --bg-card: rgba(0, 0, 0, 0.03);
            --bg-card-hover: rgba(0, 0, 0, 0.06);
            --text-primary: #1e2d42;
            --text-secondary: #3d5a80;
            --text-tertiary: #6b7280;
            --border-color: rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(to bottom, var(--bg-primary), var(--bg-secondary));
            min-height: 100vh;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .hidden { display: none !important; }
        .loading { opacity: 0.5; pointer-events: none; }

        /* HEADER */
        header {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
        }

        .logo-circle {
            width: 40px;
            height: 40px;
            background: linear-gradient(to bottom right, var(--gradient-start), var(--gradient-end));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 20px;
        }

        .logo-text {
            font-size: 20px;
            font-weight: 600;
        }

        nav {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        nav a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s;
        }

        nav a:hover {
            color: var(--text-primary);
        }

        /* BUTTONS */
        .btn {
            padding: 0.5rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 16px;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            color: white;
        }

        .btn-primary:hover {
            box-shadow: 0 10px 40px rgba(244, 162, 97, 0.4);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-secondary);
            border: 2px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-card-hover);
        }

        .btn-outline {
            background: transparent;
            color: var(--gradient-start);
            border: 2px solid var(--gradient-start);
        }

        .btn-outline:hover {
            background: rgba(244, 162, 97, 0.1);
        }

        .btn-small {
            padding: 0.4rem 1rem;
            font-size: 0.875rem;
        }

        /* HERO SECTION */
        .hero {
            max-width: 1200px;
            margin: 0 auto;
            padding: 5rem 2rem;
            text-align: center;
        }

        .hero h1 {
            font-size: 3.5rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            line-height: 1.2;
        }

        .hero .gradient-text {
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: block;
            margin-top: 0.5rem;
        }

        .hero p {
            font-size: 1.25rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .hero .btn {
            padding: 1rem 2rem;
            font-size: 1.125rem;
        }

        /* STATS */
        .stats {
            max-width: 1200px;
            margin: 4rem auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .stat-card {
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--text-secondary);
        }

        /* SECTIONS */
        .section {
            max-width: 1200px;
            margin: 5rem auto;
            padding: 0 2rem;
        }

        .section h2 {
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
        }

        .section-description {
            text-align: center;
            color: var(--text-secondary);
            max-width: 700px;
            margin: 0 auto 3rem;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .feature-card {
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 2rem;
            transition: background 0.3s;
        }

        .feature-card:hover {
            background: var(--bg-card-hover);
        }

        .feature-icon {
            width: 64px;
            height: 64px;
            background: linear-gradient(to bottom right, var(--gradient-start), var(--gradient-end));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin-bottom: 1.5rem;
        }

        .feature-card h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .feature-card p {
            color: var(--text-tertiary);
        }

        /* CTA */
        .cta {
            max-width: 1200px;
            margin: 5rem auto;
            padding: 0 2rem;
        }

        .cta-box {
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            border-radius: 24px;
            padding: 4rem 2rem;
            text-align: center;
        }

        .cta-box h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: white;
        }

        .cta-box p {
            font-size: 1.25rem;
            color: rgba(255, 255, 255, 0.9);
            max-width: 700px;
            margin: 0 auto 2rem;
        }

        .cta-box .btn {
            background: white;
            color: #3d5a80;
        }

        /* FOOTER */
        footer {
            border-top: 1px solid var(--border-color);
            background: rgba(0, 0, 0, 0.2);
            padding: 2rem;
            text-align: center;
            color: var(--text-tertiary);
        }

        /* AUTH PAGES */
        .auth-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .auth-box {
            width: 100%;
            max-width: 500px;
        }

        .auth-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .auth-form {
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 24px;
            padding: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--gradient-start);
        }

        .form-group input::placeholder, .form-group textarea::placeholder {
            color: var(--text-tertiary);
        }

        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #fca5a5;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }

        .success-message {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: #86efac;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }

        .back-link {
            margin-top: 1.5rem;
            text-align: center;
        }

        .back-link a {
            color: var(--text-tertiary);
            text-decoration: none;
        }

        .back-link a:hover {
            color: var(--text-primary);
        }

        /* DASHBOARD WITH SIDEBAR */
        .dashboard-container {
            display: flex;
            min-height: calc(100vh - 73px);
        }

        .sidebar {
            width: 250px;
            background: var(--bg-card);
            border-right: 1px solid var(--border-color);
            padding: 2rem 0;
            position: sticky;
            top: 73px;
            height: calc(100vh - 73px);
            display: flex;
            flex-direction: column;
        }

        .sidebar-nav {
            flex: 1;
        }

        .sidebar-item {
            padding: 1rem 2rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--text-secondary);
            border-left: 3px solid transparent;
        }

        .sidebar-item:hover {
            background: var(--bg-card-hover);
            color: var(--text-primary);
        }

        .sidebar-item.active {
            background: var(--bg-card-hover);
            color: var(--text-primary);
            border-left-color: var(--gradient-start);
        }

        .sidebar-icon {
            font-size: 1.25rem;
        }

        .sidebar-footer {
            border-top: 1px solid var(--border-color);
            padding-top: 1rem;
        }

        .main-content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        /* COURSE GRID */
        .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .course-card {
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.5rem;
            transition: background 0.3s;
            position: relative;
        }

        .course-card:hover {
            background: var(--bg-card-hover);
        }

        .price-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .locked-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-tertiary);
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.875rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        /* MODAL */
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            z-index: 1000;
        }

        .modal-content {
            background: linear-gradient(to bottom, var(--bg-primary), var(--bg-secondary));
            border: 1px solid var(--border-color);
            border-radius: 24px;
            padding: 2rem;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-close {
            background: transparent;
            border: none;
            color: var(--text-tertiary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
        }

        .modal-close:hover {
            color: var(--text-primary);
        }

        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%;
            margin: 2rem 0;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            overflow: hidden;
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        /* PDF LIST */
        .pdf-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .pdf-item {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .pdf-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex: 1;
        }

        .pdf-icon {
            font-size: 1.5rem;
        }

        /* FILE INPUT */
        .file-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-label {
            display: block;
            background: var(--bg-card);
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-input-label:hover {
            border-color: var(--gradient-start);
            background: rgba(244, 162, 97, 0.05);
        }

        .file-preview {
            margin-top: 1rem;
            padding: 0.75rem;
            background: var(--bg-card);
            border-radius: 8px;
            font-size: 0.875rem;
        }

        /* THEME TOGGLE */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .theme-toggle:hover {
            background: var(--bg-card-hover);
        }

        .toggle-switch {
            width: 40px;
            height: 20px;
            background: var(--border-color);
            border-radius: 999px;
            position: relative;
            transition: background 0.3s;
        }

        .toggle-switch.active {
            background: var(--gradient-start);
        }

        .toggle-knob {
            width: 16px;
            height: 16px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
        }

        .toggle-switch.active .toggle-knob {
            transform: translateX(20px);
        }

        /* TOAST NOTIFICATIONS */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            pointer-events: none;
        }

        .toast {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            min-width: 300px;
            max-width: 400px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 1rem;
            pointer-events: auto;
            animation: slideIn 0.3s ease-out;
            backdrop-filter: blur(10px);
        }

        .toast.toast-success {
            border-left: 4px solid #22c55e;
        }

        .toast.toast-error {
            border-left: 4px solid #ef4444;
        }

        .toast.toast-info {
            border-left: 4px solid var(--gradient-start);
        }

        .toast.toast-exit {
            animation: slideOut 0.3s ease-in forwards;
        }

        .toast-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--text-primary);
        }

        .toast-message {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--text-tertiary);
            cursor: pointer;
            padding: 0.25rem;
            font-size: 1.25rem;
            line-height: 1;
        }

        .toast-close:hover {
            color: var(--text-primary);
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        /* LOADING SPINNER */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--border-color);
            border-top-color: var(--gradient-start);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        .spinner-large {
            width: 40px;
            height: 40px;
            border-width: 4px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading .btn {
            position: relative;
            color: transparent;
        }

        .loading .btn::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        /* PAGE TRANSITIONS */
        .page-transition {
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* BETTER EMPTY STATES */
        .empty-state {
            background: var(--bg-card);
            border: 2px dashed var(--border-color);
            border-radius: 16px;
            padding: 3rem 2rem;
            text-align: center;
            max-width: 600px;
            margin: 2rem auto;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .empty-state p {
            color: var(--text-tertiary);
            margin-bottom: 1.5rem;
        }

        /* FAQ SEARCH */
        .faq-search-box {
            max-width: 800px;
            margin: 0 auto 2rem;
        }

        .faq-search-input {
            width: 100%;
            background: var(--bg-card);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem 1rem 1rem 3rem;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .faq-search-input:focus {
            outline: none;
            border-color: var(--gradient-start);
            box-shadow: 0 0 0 3px rgba(244, 162, 97, 0.1);
        }

        .faq-search-wrapper {
            position: relative;
        }

        .faq-search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-tertiary);
            font-size: 1.25rem;
        }

        /* FAQ ACCORDION */
        .faq-accordion {
            max-width: 800px;
            margin: 0 auto;
        }

        .faq-item {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 1rem;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .faq-item.hidden {
            display: none;
        }

        .faq-question {
            padding: 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
            transition: all 0.3s ease;
            user-select: none;
        }

        .faq-question:hover {
            background: var(--bg-card-hover);
        }

        .faq-question h3 {
            font-size: 1.125rem;
            margin: 0;
            color: var(--text-primary);
            flex: 1;
        }

        .faq-icon {
            font-size: 1.5rem;
            color: var(--gradient-start);
            transition: transform 0.3s ease;
            flex-shrink: 0;
        }

        .faq-item.active .faq-icon {
            transform: rotate(180deg);
        }

        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }

        .faq-item.active .faq-answer {
            max-height: 500px;
            padding: 0 1.5rem 1.5rem;
        }

        .faq-answer-content {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .faq-no-results {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-tertiary);
        }

        .faq-no-results-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* PROGRESS BAR */
        .progress-bar {
            width: 100%;
            height: 6px;
            background: var(--bg-card);
            border-radius: 999px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            border-radius: 999px;
            transition: width 0.3s ease;
        }

        .progress-text {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            margin-top: 0.25rem;
        }

        /* HERO VIDEO */
        .hero-video-container {
            position: relative;
            max-width: 900px;
            margin: 2rem auto 3rem;
            padding: 0 2rem;
            cursor: pointer;
        }

        .hero-video-wrapper {
            position: relative;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            background: var(--bg-secondary);
        }

        .hero-video {
            width: 100%;
            height: auto;
            display: block;
        }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .hero-video-wrapper:hover .video-overlay {
            background: rgba(0, 0, 0, 0.5);
        }

        .video-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .play-button {
            width: 150px;
            height: 150px;
            background: linear-gradient(to bottom right, var(--gradient-start), var(--gradient-end));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 30px rgba(244, 162, 97, 0.5);
            transition: all 0.3s ease;
        }

        .hero-video-wrapper:hover .play-button {
            transform: scale(1.1);
            box-shadow: 0 12px 40px rgba(244, 162, 97, 0.7);
        }

        .play-button::after {
            content: '▶';
            color: white;
            font-size: 60px;
            margin-left: 9px;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .nav-links {
                display: none;
            }

            .sidebar {
                display: none;
            }

            .course-grid {
                grid-template-columns: 1fr;
            }

            .toast-container {
                left: 10px;
                right: 10px;
                top: 10px;
            }

            .toast {
                min-width: auto;
            }
        }

        /* SOCIAL SHARE BUTTONS */
        .share-buttons {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }

        .share-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            flex: 1;
        }

        .share-btn-linkedin {
            background: #0077b5;
            color: white;
        }

        .share-btn-linkedin:hover {
            background: #005582;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 119, 181, 0.4);
        }

        .share-btn-twitter {
            background: #000000;
            color: white;
        }

        .share-btn-twitter:hover {
            background: #333333;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
        }

        .share-btn svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        /* GAMIFICATION STYLES */
        .gamification-header {
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            color: white;
        }

        .gamification-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            text-align: center;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            padding: 1rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            line-height: 1;
        }

        .stat-label {
            font-size: 0.75rem;
            opacity: 0.9;
            margin-top: 0.25rem;
        }

        .streak-fire {
            display: inline-block;
            animation: fireGlow 1s ease-in-out infinite alternate;
        }

        @keyframes fireGlow {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }

        .badge-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .badge-card {
            background: var(--bg-card);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .badge-card.earned {
            border-color: var(--gradient-start);
            background: rgba(244, 162, 97, 0.1);
        }

        .badge-card.locked {
            opacity: 0.5;
            filter: grayscale(1);
        }

        .badge-icon {
            font-size: 3rem;
            margin-bottom: 0.75rem;
            display: block;
        }

        .badge-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .badge-desc {
            font-size: 0.75rem;
            color: var(--text-tertiary);
        }

        .badge-earned-date {
            font-size: 0.7rem;
            color: var(--gradient-start);
            margin-top: 0.5rem;
        }

        .points-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            color: white;
            padding: 2rem 3rem;
            border-radius: 20px;
            font-size: 1.5rem;
            font-weight: 700;
            z-index: 10001;
            animation: pointsPopup 1.5s ease-out forwards;
            text-align: center;
            box-shadow: 0 20px 60px rgba(244, 162, 97, 0.5);
        }

        @keyframes pointsPopup {
            0% { 
                opacity: 0; 
                transform: translate(-50%, -50%) scale(0.5);
            }
            20% { 
                opacity: 1; 
                transform: translate(-50%, -50%) scale(1.1);
            }
            40% {
                transform: translate(-50%, -50%) scale(1);
            }
            80% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% { 
                opacity: 0; 
                transform: translate(-50%, -60%) scale(0.8);
            }
        }

        .sidebar-achievements {
            padding: 1rem 1.5rem;
            margin: 0.5rem 1rem;
            background: linear-gradient(135deg, rgba(244, 162, 97, 0.15), rgba(245, 124, 0, 0.15));
            border-radius: 12px;
            border: 1px solid rgba(244, 162, 97, 0.3);
        }

        .sidebar-points {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .sidebar-points-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--gradient-start);
        }

        .sidebar-streak {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .level-progress {
            background: var(--border-color);
            border-radius: 999px;
            height: 6px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .level-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
            border-radius: 999px;
            transition: width 0.5s ease;
        }

        .level-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem;
            color: var(--text-tertiary);
            margin-top: 0.25rem;
        }

        .new-badge-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10002;
            animation: fadeIn 0.3s ease;
        }

        .new-badge-content {
            background: linear-gradient(to bottom, var(--bg-primary), var(--bg-secondary));
            border: 2px solid var(--gradient-start);
            border-radius: 24px;
            padding: 3rem;
            text-align: center;
            max-width: 400px;
            animation: badgeUnlock 0.5s ease-out;
        }

        @keyframes badgeUnlock {
            0% {
                opacity: 0;
                transform: scale(0.5) rotate(-10deg);
            }
            50% {
                transform: scale(1.1) rotate(5deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0);
            }
        }

        .new-badge-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
            animation: badgeBounce 0.6s ease-out 0.3s;
        }

        @keyframes badgeBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .new-badge-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gradient-start);
            margin-bottom: 0.5rem;
        }

        .new-badge-name {
            font-size: 1.25rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .new-badge-desc {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }
    </style>
</head>
<body>
    <!-- TOAST NOTIFICATION CONTAINER -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- LANDING PAGE -->
    <div id="landingPage" class="page-transition">
        <header>
            <div class="header-content">
                <div class="logo" onclick="showPage('landing')">
                    <div class="logo-circle">W</div>
                    <span class="logo-text">Work Local</span>
                </div>
                <nav>
                    <a href="#courses" class="nav-links" onclick="showAllCourses(); return false;">Courses</a>
                    <a href="https://worklocal.ca" class="nav-links" target="_blank">About</a>
                    <button class="btn btn-secondary" onclick="showPage('signin')">Sign In</button>
                    <button class="btn btn-primary" onclick="showPage('signup')">Get Started</button>
                </nav>
            </div>
        </header>

        <section class="hero">
            <h1>
                Master AI for Your
                <span class="gradient-text">Small Business</span>
            </h1>
            <p>
                Comprehensive training programs that help small business owners integrate AI tools 
                through hands-on courses, interactive exercises, and real-world applications.
            </p>
            <div class="hero-buttons">
                <button class="btn btn-primary" onclick="showPage('signup')">Start Learning →</button>
                <button class="btn btn-secondary" onclick="showDemoVideo()">Watch Demo</button>
            </div>
        </section>

        <!-- HERO VIDEO -->
        <div class="hero-video-container">
            <div class="hero-video-wrapper" id="heroVideoWrapper" onclick="playHeroVideo()">
                <video 
                    id="heroVideo"
                    class="hero-video"
                    poster="worklocal_logo_mod.png"
                    preload="metadata"
                >
                    <source src="Woman_Welcomes_Users_to_LMS.mp4" type="video/mp4">
                    Your browser doesn't support video playback.
                </video>
                <div class="video-overlay" id="videoOverlay">
                    <div class="play-button"></div>
                </div>
            </div>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number">✓</div>
                <div class="stat-label">Certified Courses For Many Different Industries</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">✓</div>
                <div class="stat-label">Learning Solutions For Successful Business Owners</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">100%</div>
                <div class="stat-label">Practical Applications</div>
            </div>
        </div>

        <section class="section">
            <h2 style="text-align: center;">How It Works</h2>
            <p class="section-description">
                Our proven three-step learning methodology ensures you master AI implementation for your business
            </p>
            
            <div class="features">
                <div class="feature-card">
                    <div class="feature-icon">▶</div>
                    <h3>1. Watch & Learn</h3>
                    <p>Start with comprehensive video tutorials that break down complex AI concepts into digestible lessons</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">📄</div>
                    <h3>2. Review Resources</h3>
                    <p>Access detailed PDFs, templates, and reference materials to reinforce your learning</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">✔</div>
                    <h3>3. Practice & Certify</h3>
                    <p>Complete interactive exercises and earn your certification to prove your AI expertise</p>
                </div>
            </div>
        </section>

        <section class="section">
            <h2 style="text-align: center;">Why Small Businesses Need AI Training Now</h2>
            <div style="max-width: 900px; margin: 0 auto;">
                <p style="color: var(--text-secondary); font-size: 1.125rem; line-height: 1.8; margin-bottom: 1.5rem;">
                    Artificial intelligence is no longer just for tech giants and Fortune 500 companies. Small business owners across every industry—from restaurants and retail stores to healthcare providers and real estate agencies—are discovering that AI tools like ChatGPT, automated workflows, and intelligent customer service platforms can level the playing field and dramatically improve their operations.
                </p>
                
                <p style="color: var(--text-secondary); font-size: 1.125rem; line-height: 1.8; margin-bottom: 1.5rem;">
                    At Work Local, we understand that most small business owners don't have time to become AI experts. You're already wearing multiple hats—handling customers, managing employees, balancing the books, and planning for growth. That's exactly why we created practical, no-nonsense AI training specifically designed for entrepreneurs who need real results, not theoretical knowledge.
                </p>

                <h3 style="font-size: 1.75rem; margin: 2rem 0 1rem 0;">What Makes Work Local Different?</h3>
                
                <p style="color: var(--text-secondary); font-size: 1.125rem; line-height: 1.8; margin-bottom: 1.5rem;">
                    Unlike generic online courses or expensive consulting services, our AI training platform focuses exclusively on small business applications. Every course, template, and resource is designed to help you implement AI tools immediately—not months from now, but this week. You'll learn how to automate repetitive tasks, improve customer experiences, analyze your business data, and make smarter decisions using artificial intelligence.
                </p>

                <p style="color: var(--text-secondary); font-size: 1.125rem; line-height: 1.8; margin-bottom: 1.5rem;">
                    Our comprehensive curriculum covers everything from ChatGPT for business communication and content creation, to AI-powered inventory management, competitive intelligence gathering, social media automation, and customer relationship management. Each course includes video tutorials, downloadable templates, practical exercises, and interactive quizzes that ensure you're not just watching—you're actually learning and applying these powerful tools to your business.
                </p>

                <h3 style="font-size: 1.75rem; margin: 2rem 0 1rem 0;">Real Skills for Real Business Owners</h3>

                <p style="color: var(--text-secondary); font-size: 1.125rem; line-height: 1.8; margin-bottom: 1.5rem;">
                    Work Local courses are taught by experienced business professionals who understand the challenges you face every day. We don't use complicated technical jargon or assume you have a computer science degree. Instead, we provide step-by-step guidance that shows you exactly how to integrate AI into your existing workflows, whether you run a coffee shop, dental practice, boutique retail store, or consulting business.
                </p>

                <p style="color: var(--text-secondary); font-size: 1.125rem; line-height: 1.8; margin-bottom: 2rem;">
                    The future of small business success includes AI—not as a replacement for human creativity and judgment, but as a powerful assistant that amplifies your capabilities. Join thousands of small business owners who are already using artificial intelligence to save time, reduce costs, improve customer satisfaction, and grow their revenue. Start your AI training journey with Work Local today and discover how accessible and practical these game-changing tools really are.
                </p>
            </div>
        </section>

        <section class="section" style="background: var(--bg-card);">
            <h2 style="text-align: center;">Frequently Asked Questions</h2>
            <p style="text-align: center; color: var(--text-secondary); max-width: 700px; margin: 0 auto 2rem;">
                Find answers to common questions about Work Local AI training courses
            </p>

            <!-- FAQ SEARCH -->
            <div class="faq-search-box">
                <div class="faq-search-wrapper">
                    <span class="faq-search-icon">🔍</span>
                    <input 
                        type="text" 
                        id="faqSearch" 
                        class="faq-search-input" 
                        placeholder="Search frequently asked questions..."
                        onkeyup="filterFAQs()"
                    >
                </div>
            </div>

            <!-- FAQ ACCORDION -->
            <div class="faq-accordion" id="faqAccordion">
                <!-- Technical Questions -->
                <div class="faq-item" data-keywords="technical experience beginner easy learn">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h3>Do I need technical experience to learn AI tools?</h3>
                        <span class="faq-icon">▼</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            No! Our courses are specifically designed for small business owners with no technical background. We focus on practical applications and avoid complicated jargon. If you can use email and browse the web, you can learn to use AI tools for your business.
                        </div>
                    </div>
                </div>

                <!-- Time Investment -->
                <div class="faq-item" data-keywords="time duration complete course hours long">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h3>How long does it take to complete a course?</h3>
                        <span class="faq-icon">▼</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            Most courses take 2-4 hours to complete, but you can learn at your own pace. Watch videos, review materials, and practice exercises whenever it fits your schedule. Many students complete courses over a weekend or in several short sessions throughout the week.
                        </div>
                    </div>
                </div>

                <!-- Industries -->
                <div class="faq-item" data-keywords="industry restaurant retail healthcare business type suitable">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h3>What industries are your AI courses suitable for?</h3>
                        <span class="faq-icon">▼</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            We offer specialized courses for restaurants, retail stores, healthcare providers, real estate professionals, and many other industries. Our foundational AI training applies to any small business, while industry-specific courses provide targeted strategies for your particular field.
                        </div>
                    </div>
                </div>

                <!-- Certificate -->
                <div class="faq-item" data-keywords="certificate certification credential proof complete">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h3>Will I get a certificate when I complete a course?</h3>
                        <span class="faq-icon">▼</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            Yes! Upon completing a course and passing the final assessment, you'll receive a digital certificate that demonstrates your AI competency. You can share this certificate on LinkedIn, your website, or with clients to showcase your expertise.
                        </div>
                    </div>
                </div>

                <!-- Pricing -->
                <div class="faq-item" data-keywords="price cost free paid subscription money expensive">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h3>Are the AI tools you teach free or do they require subscriptions?</h3>
                        <span class="faq-icon">▼</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            We teach both free and paid AI tools. Many powerful AI solutions offer free tiers perfect for small businesses. When we cover premium tools, we clearly explain the costs and help you evaluate whether the investment makes sense for your specific business needs and budget.
                        </div>
                    </div>
                </div>

                <!-- Different from other courses -->
                <div class="faq-item" data-keywords="different unique comparison traditional courses">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h3>How is AI training different from other business courses?</h3>
                        <span class="faq-icon">▼</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            Traditional business courses teach concepts and strategies. Our AI training teaches you to use specific tools that immediately improve your business operations. You'll learn practical skills like automating customer responses, analyzing sales data, generating marketing content, and streamlining administrative tasks—capabilities that directly impact your bottom line.
                        </div>
                    </div>
                </div>

                <!-- OBJECTION HANDLING FAQs -->

                <!-- Too expensive -->
                <div class="faq-item" data-keywords="expensive afford budget cost roi worth investment">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h3>Isn't this just another expensive course that won't help my business?</h3>
                        <span class="faq-icon">▼</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            Work Local courses are designed to pay for themselves quickly. Most students implement at least one time-saving automation within the first week that saves them 2-3 hours per week. At an average business owner's time value of $50-100/hour, that's $400-1,200 in monthly value from one simple automation. Our pricing is transparent, and many courses include free resources to get started.
                        </div>
                    </div>
                </div>

                <!-- No time -->
                <div class="faq-item" data-keywords="busy time schedule overwhelmed workload">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h3>I'm already overwhelmed. Do I really have time to learn AI?</h3>
                        <span class="faq-icon">▼</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            That's exactly why you need AI! Our courses are specifically designed for busy entrepreneurs. You can complete lessons in 15-20 minute chunks, and the first automation you implement will give you back more time than you spend learning. Most students report saving 5-10 hours per week after completing just one course. It's not about finding time—it's about making time.
                        </div>
                    </div>
                </div>

                <!-- AI will replace me -->
                <div class="faq-item" data-keywords="replace job scary threat automation fear">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h3>Won't AI just replace my job or make my skills obsolete?</h3>
                        <span class="faq-icon">▼</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            AI won't replace business owners—but business owners who use AI will replace those who don't. Think of AI as your tireless assistant, not your replacement. It handles repetitive tasks so you can focus on strategy, relationships, and growth. Our training helps you stay ahead of the curve and use AI as your competitive advantage, not a threat.
                        </div>
                    </div>
                </div>

                <!-- Too complicated -->
                <div class="faq-item" data-keywords="difficult hard complex confusing complicated understand">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h3>AI seems too complicated. What if I can't understand it?</h3>
                        <span class="faq-icon">▼</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            We've taught AI to hundreds of business owners who felt the same way. Our courses assume zero technical knowledge—we literally start with "How to copy and paste a prompt." Every concept is explained in plain English with real business examples. If you can send an email or use Facebook, you can learn AI with Work Local. Plus, our support team is always here to help if you get stuck.
                        </div>
                    </div>
                </div>

                <!-- Already tried AI -->
                <div class="faq-item" data-keywords="tried chatgpt already used failed waste">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h3>I tried ChatGPT once and it didn't work. Why would this be different?</h3>
                        <span class="faq-icon">▼</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            That's like saying "I sent one email and didn't get a response, so email doesn't work." The difference is knowing HOW to use AI effectively. Our courses teach you proven prompts, frameworks, and workflows that actually work for real businesses. You'll learn the mistakes to avoid, the prompts that get results, and how to integrate AI into your actual business processes—not just experiment randomly.
                        </div>
                    </div>
                </div>

                <!-- Security concerns -->
                <div class="faq-item" data-keywords="security safe data privacy confidential information">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <h3>Is it safe to put my business information into AI tools?</h3>
                        <span class="faq-icon">▼</span>
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            Great question! We teach you best practices for data security and privacy. You'll learn which tools have business-grade security, how to anonymize sensitive information, and when to use enterprise vs. free versions. We also cover what data to never share with AI. Security is a core part of every course, not an afterthought.
                        </div>
                    </div>
                </div>
            </div>

            <!-- No Results Message -->
            <div id="faqNoResults" class="faq-no-results hidden">
                <div class="faq-no-results-icon">🔍</div>
                <h3>No matching questions found</h3>
                <p style="color: var(--text-secondary);">Try different keywords or <a href="#" onclick="clearFAQSearch(); return false;" style="color: var(--gradient-start);">clear your search</a></p>
            </div>
        </section>

        <section class="cta">
            <div class="cta-box">
                <h2>Ready to Transform Your Business with AI?</h2>
                <p>Join hundreds of small business owners who are already leveraging AI to grow their operations</p>
                <button class="btn" onclick="showPage('signup')">Start Your Free Trial</button>
            </div>
        </section>

        <footer>
            <p>© 2025 Work Local. All rights reserved.</p>
            <p style="margin-top: 0.5rem;">
                <a href="mailto:support@worklocal.ca" style="color: var(--text-secondary); text-decoration: none;">
                    Questions or Support? Contact us at support@worklocal.ca
                </a>
            </p>
            <p style="margin-top: 0.5rem; font-size: 0.75rem; color: var(--text-tertiary);">
                Version 2.3 (Build 24)
            </p>
        </footer>
    </div>

    <!-- SIGN IN PAGE -->
    <div id="signinPage" class="hidden page-transition">
        <div class="auth-container">
            <div class="auth-box">
                <div class="auth-header">
                    <div class="logo-circle" style="margin: 0 auto 1rem;">W</div>
                    <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Welcome Back</h1>
                    <p style="color: var(--text-tertiary);">Sign in to continue your learning journey</p>
                </div>

                <div class="auth-form">
                    <div id="signinError" class="error-message hidden"></div>
                    
                    <form id="signinForm" onsubmit="handleSignIn(event)">
                        <div class="form-group">
                            <label>Email Address</label>
                            <input type="email" id="signinEmail" placeholder="you@example.com" required>
                        </div>

                        <div class="form-group">
                            <label>Password</label>
                            <input type="password" id="signinPassword" placeholder="Enter your password" required>
                            <div style="text-align: right; margin-top: 0.5rem;">
                                <a href="#" onclick="showForgotPasswordModal(); return false;" style="color: var(--text-tertiary); font-size: 0.875rem; text-decoration: none;">
                                    Forgot password?
                                </a>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary" style="width: 100%; margin-bottom: 1rem;">
                            Sign In
                        </button>

                        <p style="text-align: center; color: var(--text-tertiary); font-size: 0.875rem;">
                            Don't have an account? 
                            <a href="#" onclick="showPage('signup'); return false;" style="color: var(--gradient-start); font-weight: 600;">Sign up</a>
                        </p>
                    </form>
                </div>

                <div class="back-link">
                    <a href="#" onclick="showPage('landing'); return false;">← Back to home</a>
                </div>
            </div>
        </div>
    </div>

    <!-- SIGN UP PAGE -->
    <div id="signupPage" class="hidden page-transition">
        <div class="auth-container">
            <div class="auth-box" style="max-width: 600px;">
                <div class="auth-header">
                    <div class="logo-circle" style="margin: 0 auto 1rem;">W</div>
                    <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Create Your Account</h1>
                    <p style="color: var(--text-tertiary);">Join thousands of business owners mastering AI</p>
                </div>

                <div class="auth-form">
                    <div id="signupError" class="error-message hidden"></div>
                    <div id="signupSuccess" class="success-message hidden"></div>
                    
                    <form id="signupForm" onsubmit="handleSignUp(event)">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                            <div class="form-group">
                                <label>First Name</label>
                                <input type="text" id="firstName" placeholder="John" required>
                            </div>
                            <div class="form-group">
                                <label>Last Name</label>
                                <input type="text" id="lastName" placeholder="Doe" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Email Address</label>
                            <input type="email" id="signupEmail" placeholder="you@example.com" required>
                        </div>

                        <div class="form-group">
                            <label>Business Name (Optional)</label>
                            <input type="text" id="businessName" placeholder="Your Business LLC">
                        </div>

                        <div class="form-group">
                            <label>Password</label>
                            <input type="password" id="signupPassword" placeholder="Create a strong password (min 6 characters)" required minlength="6">
                        </div>

                        <button type="submit" class="btn btn-primary" style="width: 100%; margin-bottom: 1rem;">
                            Create Student Account
                        </button>

                        <p style="text-align: center; color: var(--text-tertiary); font-size: 0.875rem;">
                            Already have an account? 
                            <a href="#" onclick="showPage('signin'); return false;" style="color: var(--gradient-start); font-weight: 600;">Sign in</a>
                        </p>
                    </form>
                </div>

                <div class="back-link">
                    <a href="#" onclick="showPage('landing'); return false;">← Back to home</a>
                </div>
            </div>
        </div>
    </div>

    <!-- DASHBOARD WITH SIDEBAR -->
    <div id="dashboard" class="hidden page-transition">
        <header>
            <div class="header-content">
                <div class="logo" onclick="location.reload()">
                    <div class="logo-circle">W</div>
                    <span class="logo-text">Work Local</span>
                </div>
                <nav>
                    <span id="userGreeting" style="color: var(--text-tertiary);"></span>
                    <button class="btn btn-secondary" onclick="handleLogout()">Logout</button>
                </nav>
            </div>
        </header>

        <div class="dashboard-container">
            <!-- SIDEBAR (Students only) -->
            <div id="studentSidebar" class="sidebar hidden">
                <div class="sidebar-nav">
                    <div class="sidebar-item active" onclick="switchView('videos')" data-view="videos">
                        <span class="sidebar-icon">▶</span>
                        <span>Video Courses</span>
                    </div>
                    <div class="sidebar-item" onclick="switchView('downloads')" data-view="downloads">
                        <span class="sidebar-icon">📄</span>
                        <span>Free Downloads</span>
                    </div>
                    <div class="sidebar-item" onclick="switchView('premium')" data-view="premium">
                        <span class="sidebar-icon">⭐</span>
                        <span>Premium Content</span>
                    </div>
                    <div class="sidebar-item" onclick="switchView('achievements')" data-view="achievements">
                        <span class="sidebar-icon">🏆</span>
                        <span>Achievements</span>
                    </div>
                </div>
                
                <!-- Gamification Mini-Stats -->
                <div class="sidebar-achievements" id="sidebarAchievements">
                    <div class="sidebar-points">
                        <span>⚡ Points</span>
                        <span class="sidebar-points-value" id="sidebarPoints">0</span>
                    </div>
                    <div class="sidebar-streak" id="sidebarStreak">
                        🔥 0 day streak
                    </div>
                    <div class="level-progress">
                        <div class="level-progress-bar" id="levelProgressBar" style="width: 0%"></div>
                    </div>
                    <div class="level-label">
                        <span id="currentLevel">Beginner</span>
                        <span id="nextLevel">→ Learner</span>
                    </div>
                </div>
                
                <div class="sidebar-footer">
                    <div class="theme-toggle" onclick="toggleTheme()">
                        <span class="sidebar-icon">☀️</span>
                        <span>Light Mode</span>
                        <div class="toggle-switch" id="themeToggle">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MAIN CONTENT -->
            <div id="dashboardContent" class="main-content">
                <!-- Content loaded dynamically -->
            </div>
        </div>

        <footer>
            <p>© 2025 Work Local. All rights reserved.</p>
            <p style="margin-top: 0.5rem;">
                <a href="mailto:support@worklocal.ca" style="color: var(--text-secondary); text-decoration: none;">
                    Questions or Support? Contact us at support@worklocal.ca
                </a>
            </p>
            <p style="margin-top: 0.5rem; font-size: 0.75rem; color: var(--text-tertiary);">
                Version 2.3 (Build 24)
            </p>
        </footer>
    </div>

    <script>
        // ========================================
        // CONFIGURATION
        // ========================================
        const SUPABASE_URL = 'https://odmwtcaqwodjvcdrirma.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9kbXd0Y2Fxd29kanZjZHJpcm1hIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyNzA0NjIsImV4cCI6MjA3Nzg0NjQ2Mn0.U-r7FmTQlI0d75VNt8xKINrhFDd0cARqrerj9nG2BDs';
        
        // ⚠️ REPLACE WITH YOUR STRIPE PUBLISHABLE KEY (starts with pk_test_...)
        const STRIPE_PUBLISHABLE_KEY = 'pk_test_51SQBjnEevaKRbfqDyoWuTAxCtc36dTcM0cgm46kKYo0uMPGSzH0aULXmmz3NcCd6Gpmr14sG89E7NrSpHjjFUfXC00JkdQ3TU8';
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        const stripe = Stripe(STRIPE_PUBLISHABLE_KEY);

        let currentUser = null;
        let userProfile = null;
        let currentStudentView = 'videos';

        // ========================================
        // TOAST NOTIFICATION SYSTEM
        // ========================================
        function showToast(message, type = 'info', duration = 4000) {
            const container = document.getElementById('toastContainer');
            
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            const icon = {
                success: '✓',
                error: '✕',
                info: 'ℹ',
                warning: '⚠'
            }[type] || 'ℹ';
            
            toast.innerHTML = `
                <div class="toast-icon">${icon}</div>
                <div class="toast-content">
                    <div class="toast-message">${message}</div>
                </div>
                <button class="toast-close" onclick="this.closest('.toast').remove()">×</button>
            `;
            
            container.appendChild(toast);
            
            // Auto-remove after duration
            if (duration > 0) {
                setTimeout(() => {
                    toast.classList.add('toast-exit');
                    setTimeout(() => toast.remove(), 300);
                }, duration);
            }
            
            return toast;
        }

        function showSuccessToast(message) {
            return showToast(message, 'success');
        }

        function showErrorToast(message) {
            return showToast(message, 'error');
        }

        function showInfoToast(message) {
            return showToast(message, 'info');
        }

        // ========================================
        // LOADING SPINNER UTILITY
        // ========================================
        function showLoadingSpinner(message = 'Loading...') {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.id = 'loadingModal';
            modal.innerHTML = `
                <div class="modal-content" style="text-align: center; max-width: 300px;">
                    <div class="spinner spinner-large" style="margin: 0 auto 1rem;"></div>
                    <p style="color: var(--text-secondary);">${message}</p>
                </div>
            `;
            document.body.appendChild(modal);
            return modal;
        }

        function hideLoadingSpinner() {
            const modal = document.getElementById('loadingModal');
            if (modal) modal.remove();
        }

        // ========================================
        // COURSE PROGRESS TRACKING
        // ========================================
        function getCourseProgress(courseId) {
            const progress = localStorage.getItem(`course_progress_${currentUser?.id}_${courseId}`);
            return progress ? JSON.parse(progress) : { started: false, completed: false, lastViewed: null, progress: 0 };
        }

        function setCourseProgress(courseId, progressData) {
            localStorage.setItem(`course_progress_${currentUser?.id}_${courseId}`, JSON.stringify({
                ...progressData,
                lastViewed: new Date().toISOString()
            }));
        }

        function markCourseAsStarted(courseId) {
            const current = getCourseProgress(courseId);
            if (!current.started) {
                setCourseProgress(courseId, { ...current, started: true, progress: 10 });
                showInfoToast('Course started! Your progress is being tracked.');
            }
        }

        function getAllCourseProgress() {
            if (!currentUser) return {};
            const progress = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith(`course_progress_${currentUser.id}_`)) {
                    const courseId = key.replace(`course_progress_${currentUser.id}_`, '');
                    progress[courseId] = JSON.parse(localStorage.getItem(key));
                }
            }
            return progress;
        }

        // ========================================
        // GAMIFICATION SYSTEM
        // ========================================
        const BADGES = {
            first_steps: { 
                id: 'first_steps', 
                icon: '👣', 
                name: 'First Steps', 
                desc: 'Start your first course',
                points: 25
            },
            curious_mind: { 
                id: 'curious_mind', 
                icon: '🔍', 
                name: 'Curious Mind', 
                desc: 'View 3 different courses',
                points: 50
            },
            learner: { 
                id: 'learner', 
                icon: '📚', 
                name: 'Dedicated Learner', 
                desc: 'View 5 video courses',
                points: 75
            },
            scholar: { 
                id: 'scholar', 
                icon: '🎓', 
                name: 'Premium Scholar', 
                desc: 'Purchase your first e-course',
                points: 100
            },
            champion: { 
                id: 'champion', 
                icon: '🏆', 
                name: 'Course Champion', 
                desc: 'Complete a premium e-course',
                points: 200
            },
            streak_3: { 
                id: 'streak_3', 
                icon: '🔥', 
                name: 'On Fire', 
                desc: 'Maintain a 3-day login streak',
                points: 50
            },
            streak_7: { 
                id: 'streak_7', 
                icon: '💥', 
                name: 'Unstoppable', 
                desc: 'Maintain a 7-day login streak',
                points: 100
            },
            downloader: { 
                id: 'downloader', 
                icon: '📥', 
                name: 'Resource Collector', 
                desc: 'Download 3 free resources',
                points: 30
            },
            ai_explorer: { 
                id: 'ai_explorer', 
                icon: '🤖', 
                name: 'AI Explorer', 
                desc: 'Earn 250 total points',
                points: 100
            },
            ai_master: { 
                id: 'ai_master', 
                icon: '🧠', 
                name: 'AI Master', 
                desc: 'Earn 500 total points',
                points: 150
            }
        };

        const LEVELS = [
            { name: 'Beginner', minPoints: 0 },
            { name: 'Learner', minPoints: 100 },
            { name: 'Explorer', minPoints: 250 },
            { name: 'Achiever', minPoints: 500 },
            { name: 'Expert', minPoints: 1000 },
            { name: 'Master', minPoints: 2000 }
        ];

        function getGamificationData() {
            if (!currentUser) return null;
            const data = localStorage.getItem(`gamification_${currentUser.id}`);
            return data ? JSON.parse(data) : {
                points: 0,
                badges: [],
                streak: 0,
                lastLoginDate: null,
                coursesViewed: [],
                downloadsCount: 0,
                premiumPurchased: false,
                premiumCompleted: false
            };
        }

        function saveGamificationData(data) {
            if (!currentUser) return;
            localStorage.setItem(`gamification_${currentUser.id}`, JSON.stringify(data));
            updateSidebarGamification();
        }

        function awardPoints(points, reason) {
            const data = getGamificationData();
            if (!data) return;
            
            data.points += points;
            saveGamificationData(data);
            
            // Check for point-based badges
            checkBadges();
        }

        function awardBadge(badgeId) {
            const data = getGamificationData();
            if (!data || data.badges.includes(badgeId)) return;
            
            const badge = BADGES[badgeId];
            data.badges.push(badgeId);
            data.points += badge.points;
            saveGamificationData(data);
            
            // Show badge unlock modal
            showBadgeUnlockModal(badge);
        }

        function showBadgeUnlockModal(badge) {
            const modal = document.createElement('div');
            modal.className = 'new-badge-modal';
            modal.innerHTML = `
                <div class="new-badge-content">
                    <div class="new-badge-icon">${badge.icon}</div>
                    <div class="new-badge-title">🎉 Badge Unlocked!</div>
                    <div class="new-badge-name">${badge.name}</div>
                    <div class="new-badge-desc">${badge.desc}</div>
                    <p style="color: var(--gradient-start); font-weight: 600;">+${badge.points} Points</p>
                    <button class="btn btn-primary" style="margin-top: 1rem;" onclick="this.closest('.new-badge-modal').remove()">
                        Awesome!
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Auto-close after 5 seconds
            setTimeout(() => {
                if (document.body.contains(modal)) {
                    modal.remove();
                }
            }, 5000);
        }

        function checkBadges() {
            const data = getGamificationData();
            if (!data) return;
            
            // Point-based badges
            if (data.points >= 250 && !data.badges.includes('ai_explorer')) {
                awardBadge('ai_explorer');
            }
            if (data.points >= 500 && !data.badges.includes('ai_master')) {
                awardBadge('ai_master');
            }
            
            // Course viewing badges
            if (data.coursesViewed.length >= 1 && !data.badges.includes('first_steps')) {
                awardBadge('first_steps');
            }
            if (data.coursesViewed.length >= 3 && !data.badges.includes('curious_mind')) {
                awardBadge('curious_mind');
            }
            if (data.coursesViewed.length >= 5 && !data.badges.includes('learner')) {
                awardBadge('learner');
            }
            
            // Download badge
            if (data.downloadsCount >= 3 && !data.badges.includes('downloader')) {
                awardBadge('downloader');
            }
            
            // Streak badges
            if (data.streak >= 3 && !data.badges.includes('streak_3')) {
                awardBadge('streak_3');
            }
            if (data.streak >= 7 && !data.badges.includes('streak_7')) {
                awardBadge('streak_7');
            }
            
            // Premium badges
            if (data.premiumPurchased && !data.badges.includes('scholar')) {
                awardBadge('scholar');
            }
            if (data.premiumCompleted && !data.badges.includes('champion')) {
                awardBadge('champion');
            }
        }

        function trackCourseView(courseId) {
            const data = getGamificationData();
            if (!data) return;
            
            if (!data.coursesViewed.includes(courseId)) {
                data.coursesViewed.push(courseId);
                saveGamificationData(data);
                awardPoints(25, 'Watched a course');
                checkBadges();
            }
        }

        function trackDownload() {
            const data = getGamificationData();
            if (!data) return;
            
            data.downloadsCount++;
            saveGamificationData(data);
            awardPoints(10, 'Downloaded a resource');
            checkBadges();
        }

        function trackPremiumPurchase() {
            const data = getGamificationData();
            if (!data) return;
            
            if (!data.premiumPurchased) {
                data.premiumPurchased = true;
                saveGamificationData(data);
                awardPoints(100, 'Purchased premium content');
                checkBadges();
            }
        }

        function trackPremiumComplete() {
            const data = getGamificationData();
            if (!data) return;
            
            if (!data.premiumCompleted) {
                data.premiumCompleted = true;
                saveGamificationData(data);
                awardPoints(200, 'Completed premium course');
                checkBadges();
            }
        }

        function trackDailyLogin() {
            const data = getGamificationData();
            if (!data) return;
            
            const today = new Date().toDateString();
            
            if (data.lastLoginDate !== today) {
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                
                if (data.lastLoginDate === yesterday.toDateString()) {
                    data.streak++;
                } else if (data.lastLoginDate !== today) {
                    data.streak = 1;
                }
                
                data.lastLoginDate = today;
                saveGamificationData(data);
                
                if (data.streak > 1) {
                    awardPoints(5 * data.streak, `${data.streak}-day streak bonus!`);
                } else {
                    awardPoints(10, 'Daily login');
                }
                
                checkBadges();
            }
        }

        function getCurrentLevel(points) {
            for (let i = LEVELS.length - 1; i >= 0; i--) {
                if (points >= LEVELS[i].minPoints) {
                    return {
                        current: LEVELS[i],
                        next: LEVELS[i + 1] || null,
                        index: i
                    };
                }
            }
            return { current: LEVELS[0], next: LEVELS[1], index: 0 };
        }

        function updateSidebarGamification() {
            const data = getGamificationData();
            if (!data) return;
            
            const pointsEl = document.getElementById('sidebarPoints');
            const streakEl = document.getElementById('sidebarStreak');
            const progressEl = document.getElementById('levelProgressBar');
            const currentLevelEl = document.getElementById('currentLevel');
            const nextLevelEl = document.getElementById('nextLevel');
            
            if (pointsEl) pointsEl.textContent = data.points;
            if (streakEl) {
                const fire = data.streak >= 3 ? '<span class="streak-fire">🔥</span>' : '🔥';
                streakEl.innerHTML = `${fire} ${data.streak} day streak`;
            }
            
            const levelInfo = getCurrentLevel(data.points);
            if (currentLevelEl) currentLevelEl.textContent = levelInfo.current.name;
            
            if (levelInfo.next) {
                if (nextLevelEl) nextLevelEl.textContent = `→ ${levelInfo.next.name}`;
                const progress = ((data.points - levelInfo.current.minPoints) / 
                    (levelInfo.next.minPoints - levelInfo.current.minPoints)) * 100;
                if (progressEl) progressEl.style.width = `${Math.min(progress, 100)}%`;
            } else {
                if (nextLevelEl) nextLevelEl.textContent = 'MAX';
                if (progressEl) progressEl.style.width = '100%';
            }
        }

        function loadAchievementsView() {
            const content = document.getElementById('dashboardContent');
            const data = getGamificationData() || { points: 0, badges: [], streak: 0 };
            const levelInfo = getCurrentLevel(data.points);
            
            content.innerHTML = `
                <div class="gamification-header">
                    <h2 style="margin-bottom: 1rem; font-size: 1.5rem;">Your Achievements</h2>
                    <div class="gamification-stats">
                        <div class="stat-item">
                            <div class="stat-value">⚡ ${data.points}</div>
                            <div class="stat-label">Total Points</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${data.streak >= 3 ? '<span class="streak-fire">🔥</span>' : '🔥'} ${data.streak}</div>
                            <div class="stat-label">Day Streak</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">🏅 ${data.badges.length}/${Object.keys(BADGES).length}</div>
                            <div class="stat-label">Badges Earned</div>
                        </div>
                    </div>
                    <div style="margin-top: 1.5rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span>Level: ${levelInfo.current.name}</span>
                            <span>${levelInfo.next ? `Next: ${levelInfo.next.name} (${levelInfo.next.minPoints} pts)` : 'MAX LEVEL!'}</span>
                        </div>
                        <div class="level-progress" style="height: 10px;">
                            <div class="level-progress-bar" style="width: ${levelInfo.next ? ((data.points - levelInfo.current.minPoints) / (levelInfo.next.minPoints - levelInfo.current.minPoints)) * 100 : 100}%"></div>
                        </div>
                    </div>
                </div>
                
                <h3 style="margin-bottom: 1rem;">🏆 Badges</h3>
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">Earn badges by completing activities and reaching milestones!</p>
                
                <div class="badge-grid">
                    ${Object.values(BADGES).map(badge => {
                        const earned = data.badges.includes(badge.id);
                        return `
                            <div class="badge-card ${earned ? 'earned' : 'locked'}">
                                <span class="badge-icon">${badge.icon}</span>
                                <div class="badge-name">${badge.name}</div>
                                <div class="badge-desc">${badge.desc}</div>
                                ${earned ? 
                                    `<div class="badge-earned-date">✓ Earned (+${badge.points} pts)</div>` : 
                                    `<div class="badge-desc" style="margin-top: 0.5rem; color: var(--gradient-start);">+${badge.points} pts</div>`
                                }
                            </div>
                        `;
                    }).join('')}
                </div>
                
                <div style="margin-top: 3rem; padding: 2rem; background: var(--bg-card); border-radius: 16px; border: 1px solid var(--border-color);">
                    <h3 style="margin-bottom: 1rem;">📊 How to Earn Points</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div style="color: var(--text-secondary);">
                            <strong style="color: var(--text-primary);">+25 pts</strong> - Watch a video course
                        </div>
                        <div style="color: var(--text-secondary);">
                            <strong style="color: var(--text-primary);">+10 pts</strong> - Download a resource
                        </div>
                        <div style="color: var(--text-secondary);">
                            <strong style="color: var(--text-primary);">+100 pts</strong> - Purchase premium content
                        </div>
                        <div style="color: var(--text-secondary);">
                            <strong style="color: var(--text-primary);">+200 pts</strong> - Complete a premium course
                        </div>
                        <div style="color: var(--text-secondary);">
                            <strong style="color: var(--text-primary);">+10 pts</strong> - Daily login
                        </div>
                        <div style="color: var(--text-secondary);">
                            <strong style="color: var(--text-primary);">+5×streak</strong> - Streak bonus
                        </div>
                    </div>
                </div>
            `;
        }

        // ========================================
        // SOCIAL SHARING (Premium Courses)
        // ========================================
        function shareOnLinkedIn(courseTitle) {
            const text = encodeURIComponent(`🎓 I just completed "${courseTitle}" on Work Local - AI Training for Small Business Owners! Learning AI tools to grow my business. #AITraining #SmallBusiness #WorkLocal`);
            const url = encodeURIComponent('https://work-local-lms.netlify.app');
            window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}&summary=${text}`, '_blank', 'width=600,height=400');
        }

        function shareOnTwitter(courseTitle) {
            const text = encodeURIComponent(`🎓 Just completed "${courseTitle}" on @WorkLocal! Learning AI tools to grow my business 🚀 #AITraining #SmallBusiness`);
            const url = encodeURIComponent('https://work-local-lms.netlify.app');
            window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, '_blank', 'width=600,height=400');
        }

        // ========================================
        // INITIALIZATION
        // ========================================
        async function init() {
            loadThemePreference();
            
            // Check for payment status in URL before session check
            const urlParams = new URLSearchParams(window.location.search);
            const paymentStatus = urlParams.get('payment');
            const viewParam = urlParams.get('view');
            
            const { data: { session } } = await supabase.auth.getSession();
            
            if (session) {
                currentUser = session.user;
                await loadUserProfile();
                showDashboard();
                
                // Track daily login for gamification
                trackDailyLogin();
                updateSidebarGamification();
                
                // After dashboard is loaded, check payment status and navigate
                if (paymentStatus === 'success') {
                    setTimeout(() => {
                        showSuccessToast('🎉 Payment Successful! Your e-course has been unlocked.');
                        
                        // Track premium purchase for gamification
                        trackPremiumPurchase();
                        
                        // Navigate to My Courses if view parameter is set
                        if (viewParam === 'courses') {
                            switchView('premium');
                        }
                        
                        // Clean URL
                        window.history.replaceState({}, document.title, window.location.pathname);
                    }, 500);
                } else if (paymentStatus === 'cancelled') {
                    setTimeout(() => {
                        showInfoToast('Payment was cancelled. You can try again anytime.');
                        window.history.replaceState({}, document.title, window.location.pathname);
                    }, 500);
                }
            } else {
                // Not logged in, just check for payment status
                checkPaymentStatus();
            }

            supabase.auth.onAuthStateChange((event, session) => {
                if (event === 'SIGNED_IN') {
                    currentUser = session.user;
                    loadUserProfile().then(() => showDashboard());
                } else if (event === 'SIGNED_OUT') {
                    currentUser = null;
                    userProfile = null;
                    showPage('landing');
                }
            });
        }

        // ========================================
        // PAYMENT STATUS CHECKER (for non-authenticated users)
        // ========================================
        function checkPaymentStatus() {
            const urlParams = new URLSearchParams(window.location.search);
            const paymentStatus = urlParams.get('payment');
            
            if (paymentStatus === 'success') {
                setTimeout(() => {
                    showSuccessToast('🎉 Payment Successful! Please sign in to access your e-course.');
                    window.history.replaceState({}, document.title, window.location.pathname);
                }, 500);
            } else if (paymentStatus === 'cancelled') {
                setTimeout(() => {
                    showInfoToast('Payment was cancelled. You can try again anytime.');
                    window.history.replaceState({}, document.title, window.location.pathname);
                }, 500);
            }
        }

        // ========================================
        // THEME MANAGEMENT
        // ========================================
        function loadThemePreference() {
            const theme = localStorage.getItem('theme') || 'dark';
            if (theme === 'light') {
                document.documentElement.setAttribute('data-theme', 'light');
                const toggle = document.getElementById('themeToggle');
                if (toggle) toggle.classList.add('active');
            }
        }

        function toggleTheme() {
            const html = document.documentElement;
            const toggle = document.getElementById('themeToggle');
            const isLight = html.getAttribute('data-theme') === 'light';
            
            if (isLight) {
                // Switch to dark
                html.removeAttribute('data-theme');
                toggle.classList.remove('active');
                localStorage.setItem('theme', 'dark');
            } else {
                // Switch to light
                html.setAttribute('data-theme', 'light');
                toggle.classList.add('active');
                localStorage.setItem('theme', 'light');
            }
        }

        // ========================================
        // AUTHENTICATION
        // ========================================
        async function handleSignUp(event) {
            event.preventDefault();
            
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const businessName = document.getElementById('businessName').value;

            const errorDiv = document.getElementById('signupError');
            const successDiv = document.getElementById('signupSuccess');
            errorDiv.classList.add('hidden');
            successDiv.classList.add('hidden');

            const form = document.getElementById('signupForm');
            form.classList.add('loading');

            try {
                const { data, error } = await supabase.auth.signUp({
                    email: email,
                    password: password,
                    options: {
                        data: {
                            role: 'student',
                            first_name: firstName,
                            last_name: lastName,
                            business_name: businessName
                        }
                    }
                });

                if (error) throw error;

                if (data.user) {
                    await supabase.from('profiles').update({
                        first_name: firstName,
                        last_name: lastName,
                        business_name: businessName
                    }).eq('id', data.user.id);
                }

                successDiv.textContent = 'Account created successfully! Please check your email to verify your account, then sign in.';
                successDiv.classList.remove('hidden');
                
                form.reset();
                
                setTimeout(() => {
                    showPage('signin');
                }, 3000);

            } catch (error) {
                errorDiv.textContent = error.message;
                errorDiv.classList.remove('hidden');
            } finally {
                form.classList.remove('loading');
            }
        }

        async function handleSignIn(event) {
            event.preventDefault();
            
            const email = document.getElementById('signinEmail').value;
            const password = document.getElementById('signinPassword').value;

            const errorDiv = document.getElementById('signinError');
            errorDiv.classList.add('hidden');

            const form = document.getElementById('signinForm');
            form.classList.add('loading');

            try {
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });

                if (error) throw error;

                currentUser = data.user;
                await loadUserProfile();
                
                document.getElementById('signinPage').classList.add('hidden');
                document.getElementById('signupPage').classList.add('hidden');
                document.getElementById('landingPage').classList.add('hidden');
                
                showDashboard();

            } catch (error) {
                errorDiv.textContent = error.message;
                errorDiv.classList.remove('hidden');
            } finally {
                form.classList.remove('loading');
            }
        }

        async function handleLogout() {
            await supabase.auth.signOut();
            currentUser = null;
            userProfile = null;
            showPage('landing');
        }

        // ========================================
        // PASSWORD RESET
        // ========================================
        function showForgotPasswordModal() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px;">
                    <div class="modal-header">
                        <h2>Reset Password</h2>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">✕</button>
                    </div>

                    <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                        Enter your email address and we'll send you a link to reset your password.
                    </p>

                    <div id="resetError" class="error-message hidden"></div>
                    <div id="resetSuccess" class="success-message hidden"></div>

                    <form id="resetPasswordForm" onsubmit="handlePasswordReset(event)">
                        <div class="form-group">
                            <label>Email Address</label>
                            <input type="email" id="resetEmail" placeholder="you@example.com" required>
                        </div>

                        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                            <button type="button" class="btn btn-secondary" style="flex: 1;" onclick="this.closest('.modal').remove()">
                                Cancel
                            </button>
                            <button type="submit" class="btn btn-primary" style="flex: 1;">
                                Send Reset Link
                            </button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
        }

        async function handlePasswordReset(event) {
            event.preventDefault();

            const form = event.target;
            const email = document.getElementById('resetEmail').value;
            const errorDiv = document.getElementById('resetError');
            const successDiv = document.getElementById('resetSuccess');

            errorDiv.classList.add('hidden');
            successDiv.classList.add('hidden');
            form.classList.add('loading');

            try {
                const { error } = await supabase.auth.resetPasswordForEmail(email, {
                    redirectTo: window.location.origin + '/reset-password'
                });

                if (error) throw error;

                successDiv.textContent = 'Password reset link sent! Check your email inbox.';
                successDiv.classList.remove('hidden');
                
                form.reset();
                
                setTimeout(() => {
                    form.closest('.modal').remove();
                }, 3000);

            } catch (error) {
                errorDiv.textContent = error.message;
                errorDiv.classList.remove('hidden');
            } finally {
                form.classList.remove('loading');
            }
        }

        async function loadUserProfile() {
            if (!currentUser) return;

            try {
                const { data, error } = await supabase
                    .from('profiles')
                    .select('*')
                    .eq('id', currentUser.id)
                    .single();

                if (error) throw error;
                userProfile = data;
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        }

        // ========================================
        // FAQ ACCORDION & SEARCH
        // ========================================
        function toggleFAQ(questionElement) {
            const faqItem = questionElement.closest('.faq-item');
            const wasActive = faqItem.classList.contains('active');
            
            // Close all other FAQs
            document.querySelectorAll('.faq-item.active').forEach(item => {
                if (item !== faqItem) {
                    item.classList.remove('active');
                }
            });
            
            // Toggle current FAQ
            if (wasActive) {
                faqItem.classList.remove('active');
            } else {
                faqItem.classList.add('active');
            }
        }

        function filterFAQs() {
            const searchInput = document.getElementById('faqSearch');
            const searchTerm = searchInput.value.toLowerCase().trim();
            const faqItems = document.querySelectorAll('.faq-item');
            const noResults = document.getElementById('faqNoResults');
            let visibleCount = 0;

            faqItems.forEach(item => {
                const question = item.querySelector('h3').textContent.toLowerCase();
                const answer = item.querySelector('.faq-answer-content').textContent.toLowerCase();
                const keywords = item.getAttribute('data-keywords') || '';
                
                const searchableText = question + ' ' + answer + ' ' + keywords;
                
                if (searchTerm === '' || searchableText.includes(searchTerm)) {
                    item.classList.remove('hidden');
                    visibleCount++;
                } else {
                    item.classList.add('hidden');
                    item.classList.remove('active');
                }
            });

            // Show/hide no results message
            if (visibleCount === 0) {
                noResults.classList.remove('hidden');
            } else {
                noResults.classList.add('hidden');
            }
        }

        function clearFAQSearch() {
            document.getElementById('faqSearch').value = '';
            filterFAQs();
        }

        // ========================================
        // HERO VIDEO
        // ========================================
        function playHeroVideo() {
            const video = document.getElementById('heroVideo');
            const overlay = document.getElementById('videoOverlay');
            
            if (!video) {
                console.error('Video element not found');
                return;
            }
            
            if (video.paused) {
                // Attempt to play with error handling
                const playPromise = video.play();
                
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        // Video started successfully
                        overlay.classList.add('hidden');
                        console.log('Video playing');
                    }).catch(error => {
                        // Play failed - show error
                        console.error('Error playing video:', error);
                        showErrorToast('Unable to play video. Please check your connection.');
                    });
                }
                
                // Show overlay again when video ends
                video.onended = function() {
                    overlay.classList.remove('hidden');
                    video.currentTime = 0;
                };
            } else {
                video.pause();
                overlay.classList.remove('hidden');
            }
        }

        // ========================================
        // DEMO VIDEO
        // ========================================
        function showDemoVideo() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Work Local Demo</h2>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">✕</button>
                    </div>

                    <div class="video-container">
                        <iframe 
                            src="https://www.youtube.com/embed/u0gh0bxd2OE?autoplay=1" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen>
                        </iframe>
                    </div>

                    <button class="btn btn-secondary" style="width: 100%; margin-top: 2rem;" onclick="this.closest('.modal').remove()">
                        Close
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ========================================
        // SHOW ALL COURSES (LANDING PAGE)
        // ========================================
        async function showAllCourses() {
            const { data: courses, error } = await supabase
                .from('courses')
                .select('*')
                .eq('is_published', true)
                .order('created_at', { ascending: false });

            const courseList = courses || [];

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 900px;">
                    <div class="modal-header">
                        <h2>Available Courses</h2>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">✕</button>
                    </div>

                    ${courseList.length === 0 ? `
                        <p style="color: var(--text-tertiary); text-align: center; padding: 2rem;">
                            No courses available yet. Check back soon!
                        </p>
                    ` : `
                        <div class="course-grid">
                            ${courseList.map(course => `
                                <div class="course-card">
                                    <h3>${course.title}</h3>
                                    <p style="color: var(--text-tertiary); font-size: 0.875rem; margin: 0.5rem 0 1rem 0;">${course.description}</p>
                                    <p style="color: var(--text-tertiary); font-size: 0.875rem; margin-bottom: 1rem;">
                                        ${course.category}${course.duration ? ' • ' + course.duration : ''}
                                    </p>
                                    <button class="btn btn-primary" style="width: 100%;" onclick="this.closest('.modal').remove(); showPage('signup')">
                                        Enroll Now
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    `}

                    <button class="btn btn-secondary" style="width: 100%; margin-top: 2rem;" onclick="this.closest('.modal').remove()">
                        Close
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ========================================
        // NAVIGATION
        // ========================================
        function showPage(page) {
            document.getElementById('landingPage').classList.add('hidden');
            document.getElementById('signinPage').classList.add('hidden');
            document.getElementById('signupPage').classList.add('hidden');
            document.getElementById('dashboard').classList.add('hidden');

            if (page === 'landing') {
                document.getElementById('landingPage').classList.remove('hidden');
            } else if (page === 'signin') {
                document.getElementById('signinPage').classList.remove('hidden');
            } else if (page === 'signup') {
                document.getElementById('signupPage').classList.remove('hidden');
            }

            window.scrollTo(0, 0);
        }

        function switchView(view) {
            currentStudentView = view;
            
            // Update active sidebar item
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.view === view) {
                    item.classList.add('active');
                }
            });

            // Load appropriate content
            if (view === 'videos') {
                loadVideoCourses();
            } else if (view === 'downloads') {
                loadFreeDownloads();
            } else if (view === 'premium') {
                loadPremiumContent();
            } else if (view === 'achievements') {
                loadAchievementsView();
            }
        }

        // ========================================
        // DASHBOARD
        // ========================================
        async function showDashboard() {
            if (!userProfile) return;

            document.getElementById('dashboard').classList.remove('hidden');
            
            const greeting = document.getElementById('userGreeting');
            greeting.textContent = `Welcome, ${userProfile.first_name || 'User'}!`;

            if (userProfile.role === 'teacher') {
                document.getElementById('studentSidebar').classList.add('hidden');
                await loadTeacherDashboard();
            } else {
                document.getElementById('studentSidebar').classList.remove('hidden');
                // Load the current view (in case returning from modal/new tab)
                switchView(currentStudentView);
            }
        }

        // ========================================
        // STUDENT VIEWS
        // ========================================
        async function loadVideoCourses() {
            const content = document.getElementById('dashboardContent');
            
            const { data: courses, error } = await supabase
                .from('courses')
                .select('*')
                .eq('is_published', true)
                .order('created_at', { ascending: false });

            const courseCount = courses ? courses.length : 0;
            
            content.innerHTML = `
                <h2>Video Courses</h2>
                <p style="color: var(--text-secondary); margin-bottom: 2rem;">
                    Watch comprehensive video tutorials to master AI for your business
                </p>
                
                ${courseCount === 0 ? `
                    <div class="empty-state">
                        <div class="empty-state-icon">📚</div>
                        <h3>No Courses Available Yet</h3>
                        <p>We're working on amazing AI training courses for you. Check back soon!</p>
                    </div>
                ` : `
                    <div class="course-grid">
                        ${courses.map(course => {
                            const progress = getCourseProgress(course.id);
                            const buttonText = progress.started ? 
                                (progress.completed ? '✓ Completed' : 'Continue Learning') : 
                                'Start Course';
                            return `
                            <div class="course-card">
                                <h3>${course.title}</h3>
                                <p style="color: var(--text-tertiary); font-size: 0.875rem; margin: 0.5rem 0 1rem 0;">${course.description}</p>
                                <p style="color: var(--text-tertiary); font-size: 0.875rem; margin-bottom: 1rem;">
                                    ${course.category}${course.duration ? ' • ' + course.duration : ''}
                                </p>
                                ${progress.started ? `
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: ${progress.progress}%"></div>
                                    </div>
                                    <div class="progress-text">${progress.progress}% complete</div>
                                ` : ''}
                                <button class="btn btn-primary" style="width: 100%; margin-top: ${progress.started ? '0.5rem' : '0'};" onclick="viewCourse('${course.id}')">
                                    ${buttonText}
                                </button>
                            </div>
                        `;
                        }).join('')}
                    </div>
                `}
            `;
        }

        async function loadFreeDownloads() {
            const content = document.getElementById('dashboardContent');
            
            const { data: pdfs, error } = await supabase
                .from('course_pdfs')
                .select(`
                    *,
                    courses!inner(title, is_published)
                `)
                .eq('courses.is_published', true)
                .order('created_at', { ascending: false });

            const pdfCount = pdfs ? pdfs.length : 0;
            
            content.innerHTML = `
                <h2>Free Downloads</h2>
                <p style="color: var(--text-secondary); margin-bottom: 2rem;">
                    Access all free PDF resources, workbooks, and templates
                </p>
                
                ${pdfCount === 0 ? `
                    <div class="empty-state">
                        <div class="empty-state-icon">📄</div>
                        <h3>No Downloads Available Yet</h3>
                        <p>Free PDF resources, workbooks, and templates are coming soon!</p>
                    </div>
                ` : `
                    <div class="pdf-list" style="max-width: 800px;">
                        ${pdfs.map(pdf => `
                            <div class="pdf-item">
                                <div class="pdf-info">
                                    <span class="pdf-icon">📄</span>
                                    <div>
                                        <div style="font-weight: 600;">${pdf.title}</div>
                                        <div style="font-size: 0.875rem; color: var(--text-tertiary);">From: ${pdf.courses.title}</div>
                                    </div>
                                </div>
                                <a href="${pdf.file_url}" download target="_blank" class="btn btn-primary btn-small" onclick="trackDownload()">
                                    Download
                                </a>
                            </div>
                        `).join('')}
                    </div>
                `}
            `;
        }

        async function loadPremiumContent() {
            const content = document.getElementById('dashboardContent');
            
            // Load all e-courses
            const { data: ecourses, error: ecoursesError } = await supabase
                .from('ecourses')
                .select(`
                    *,
                    courses!inner(title, is_published)
                `)
                .eq('is_published', true)
                .eq('courses.is_published', true)
                .order('created_at', { ascending: false });

            // DEBUG: Log to console
            console.log('E-courses query result:', ecourses, ecoursesError);

            // Load user's purchases
            const { data: purchases, error: purchasesError } = await supabase
                .from('purchases')
                .select('ecourse_id')
                .eq('user_id', currentUser.id);

            const purchasedIds = purchases ? purchases.map(p => p.ecourse_id) : [];
            const ecourseCount = ecourses ? ecourses.length : 0;
            
            content.innerHTML = `
                <h2>Premium Content</h2>
                <p style="color: var(--text-secondary); margin-bottom: 2rem;">
                    Interactive e-courses with quizzes, exercises, and hands-on practice
                </p>
                
                ${ecourseCount === 0 ? `
                    <div class="empty-state">
                        <div class="empty-state-icon">⭐</div>
                        <h3>No Premium Content Available Yet</h3>
                        <p>Interactive e-courses with quizzes and exercises are coming soon!</p>
                    </div>
                ` : `
                    <div class="course-grid">
                        ${ecourses.map(ecourse => {
                            const isPurchased = purchasedIds.includes(ecourse.id);
                            const escapedTitle = ecourse.title.replace(/'/g, "\\'").replace(/"/g, '&quot;');
                            return `
                                <div class="course-card">
                                    ${isPurchased ? 
                                        '<div class="price-badge">✓ Purchased</div>' : 
                                        `<div class="price-badge">${ecourse.price}</div>`
                                    }
                                    <h3>${ecourse.title}</h3>
                                    <p style="color: var(--text-tertiary); font-size: 0.875rem; margin: 0.5rem 0 1rem 0;">${ecourse.description || ''}</p>
                                    <p style="color: var(--text-tertiary); font-size: 0.875rem; margin-bottom: 1rem;">
                                        From: ${ecourse.courses.title}
                                    </p>
                                    ${isPurchased ? 
                                        `<button class="btn btn-primary" style="width: 100%;" onclick="event.preventDefault(); openEcourse('${ecourse.file_url}')">
                                            Open E-Course
                                        </button>
                                        <div class="share-buttons">
                                            <button class="share-btn share-btn-linkedin" onclick="shareOnLinkedIn('${escapedTitle}')">
                                                <svg viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                                                Share
                                            </button>
                                            <button class="share-btn share-btn-twitter" onclick="shareOnTwitter('${escapedTitle}')">
                                                <svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                                                Share
                                            </button>
                                        </div>` :
                                        `<button class="btn btn-primary" style="width: 100%;" onclick="event.preventDefault(); initiateCheckout('${ecourse.id}', '${escapedTitle}', ${ecourse.price})">
                                            Buy Now - ${ecourse.price}
                                        </button>`
                                    }
                                </div>
                            `;
                        }).join('')}
                    </div>
                `}
            `;
        }

        async function openEcourse(fileUrl) {
            console.log('ECOURSE_MODAL_FIX_ACTIVE');
            console.log('Opening e-course:', fileUrl);
            
            try {
                const loadingModal = document.createElement('div');
                loadingModal.className = 'modal';
                loadingModal.innerHTML = `
                    <div class="modal-content" style="text-align: center;">
                        <p style="font-size: 1.5rem; margin: 2rem;">Loading e-course...</p>
                    </div>
                `;
                document.body.appendChild(loadingModal);

                const response = await fetch(fileUrl);
                const htmlContent = await response.text();
                
                const blob = new Blob([htmlContent], { type: 'text/html' });
                const blobUrl = URL.createObjectURL(blob);
                
                loadingModal.remove();
                
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.style.padding = '0';
                modal.innerHTML = `
                    <div style="width: 100%; height: 100vh; max-width: 100%; max-height: 100%; background: white; display: flex; flex-direction: column;">
                        <div style="background: linear-gradient(to bottom, var(--bg-primary), var(--bg-secondary)); padding: 1rem; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color);">
                            <h2 style="margin: 0; color: var(--text-primary);">E-Course Viewer</h2>
                            <button class="btn btn-secondary btn-small" onclick="this.closest('.modal').remove(); URL.revokeObjectURL('${blobUrl}')">
                                Close
                            </button>
                        </div>
                        <iframe 
                            src="${blobUrl}" 
                            style="flex: 1; width: 100%; border: none; background: white;"
                            sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-modals allow-downloads"
                        ></iframe>
                    </div>
                `;
                document.body.appendChild(modal);
                console.log('E-course modal displayed successfully');
                
            } catch (error) {
                console.error('Error opening e-course:', error);
                showErrorToast('Error opening e-course: ' + error.message);
            }
        }

        // ========================================
        // STRIPE CHECKOUT (REAL IMPLEMENTATION)
        // ========================================
        async function initiateCheckout(ecourseId, title, price) {
            try {
                // Show loading state
                const loadingModal = document.createElement('div');
                loadingModal.className = 'modal';
                loadingModal.innerHTML = `
                    <div class="modal-content" style="text-align: center;">
                        <h2 style="margin-bottom: 1rem;">Processing...</h2>
                        <p style="color: var(--text-tertiary);">Creating secure checkout session...</p>
                    </div>
                `;
                document.body.appendChild(loadingModal);

                // Call Supabase Edge Function to create Stripe Checkout Session
                const { data: functionData, error: functionError } = await supabase.functions.invoke('create-checkout-session', {
                    body: {
                        ecourseId: ecourseId,
                        ecourseTitle: title,
                        price: price,
                        userId: currentUser.id,
                        userEmail: currentUser.email
                    }
                });

                loadingModal.remove();

                if (functionError) {
                    throw new Error(functionError.message || 'Failed to create checkout session');
                }

                if (!functionData || !functionData.sessionId) {
                    throw new Error('Invalid response from checkout service');
                }

                // Redirect to Stripe Checkout
                const { error: stripeError } = await stripe.redirectToCheckout({
                    sessionId: functionData.sessionId
                });

                if (stripeError) {
                    throw stripeError;
                }

            } catch (error) {
                console.error('Checkout error:', error);
                showErrorToast('Error creating checkout session. Please try again or contact support.');
            }
        }

        // ========================================
        // TEACHER DASHBOARD
        // ========================================
        async function loadTeacherDashboard() {
            const content = document.getElementById('dashboardContent');
            
            const { data: courses, error } = await supabase
                .from('courses')
                .select('*')
                .eq('instructor_id', currentUser.id)
                .order('created_at', { ascending: false });

            const courseCount = courses ? courses.length : 0;

            content.innerHTML = `
                <h2>Instructor Dashboard</h2>
                
                <div class="stats" style="margin: 2rem 0;">
                    <div class="stat-card">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">📚</div>
                        <div class="stat-number">${courseCount}</div>
                        <div class="stat-label">Your Courses</div>
                    </div>
                    <div class="stat-card">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">👥</div>
                        <div class="stat-number">0</div>
                        <div class="stat-label">Total Students</div>
                    </div>
                    <div class="stat-card">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">💰</div>
                        <div class="stat-number">$0</div>
                        <div class="stat-label">Total Revenue</div>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="showCreateCourseModal()" style="margin-bottom: 2rem;">
                    + Create New Course
                </button>

                <div id="coursesList">
                    ${courseCount === 0 ? `
                        <div class="empty-state">
                            <div class="empty-state-icon">🎓</div>
                            <h3>Ready to Create Your First Course?</h3>
                            <p>Click "Create New Course" above to start building amazing AI training content!</p>
                            <button class="btn btn-primary" onclick="showCreateCourseModal()" style="margin-top: 1rem;">
                                + Create Your First Course
                            </button>
                        </div>
                    ` : `
                        <h3 style="margin-bottom: 1rem;">Your Courses</h3>
                        <div class="course-grid">
                            ${courses.map(course => `
                                <div class="course-card">
                                    <h3>${course.title}</h3>
                                    <p style="color: var(--text-tertiary); font-size: 0.875rem; margin: 0.5rem 0;">${course.description}</p>
                                    <p style="color: var(--text-tertiary); font-size: 0.875rem; margin-bottom: 1rem;">
                                        ${course.category} • ${course.is_published ? '✓ Published' : 'Draft'}
                                    </p>
                                    <div style="display: flex; gap: 0.5rem; margin-bottom: 0.5rem;">
                                        <button class="btn btn-outline" style="flex: 1;" onclick="editCourse('${course.id}')">
                                            Edit
                                        </button>
                                        <button class="btn ${course.is_published ? 'btn-secondary' : 'btn-primary'}" style="flex: 1;" onclick="togglePublish('${course.id}', ${course.is_published})">
                                            ${course.is_published ? 'Unpublish' : 'Publish'}
                                        </button>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="btn btn-outline btn-small" style="flex: 1;" onclick="managePDFs('${course.id}')">
                                            📄 PDFs
                                        </button>
                                        <button class="btn btn-outline btn-small" style="flex: 1;" onclick="manageEcourses('${course.id}')">
                                            ⭐ E-Courses
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `}
                </div>
            `;
        }

        // ========================================
        // COURSE MANAGEMENT (unchanged)
        // ========================================
        function showCreateCourseModal() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Create New Course</h2>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">✕</button>
                    </div>

                    <form id="createCourseForm" onsubmit="handleCreateCourse(event)">
                        <div class="form-group">
                            <label>Course Title</label>
                            <input type="text" id="courseTitle" placeholder="e.g., AI for Restaurant Management" required>
                        </div>

                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="courseDescription" rows="3" placeholder="Brief description of what students will learn..." required></textarea>
                        </div>

                        <div class="form-group">
                            <label>Category</label>
                            <select id="courseCategory" required>
                                <option value="">Select a category</option>
                                <option value="Restaurant">Restaurant</option>
                                <option value="Retail">Retail</option>
                                <option value="Healthcare">Healthcare</option>
                                <option value="Real Estate">Real Estate</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>YouTube Video URL (paste full URL)</label>
                            <input type="url" id="courseVideoUrl" placeholder="https://www.youtube.com/watch?v=..." required>
                            <p style="color: var(--text-tertiary); font-size: 0.75rem; margin-top: 0.5rem;">
                                Paste your YouTube unlisted video URL here
                            </p>
                        </div>

                        <div class="form-group">
                            <label>Duration (e.g., "4 hours")</label>
                            <input type="text" id="courseDuration" placeholder="e.g., 4 hours">
                        </div>

                        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                            <button type="button" class="btn btn-secondary" style="flex: 1;" onclick="this.closest('.modal').remove()">Cancel</button>
                            <button type="submit" class="btn btn-primary" style="flex: 1;">Create Course</button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
        }

        async function handleCreateCourse(event) {
            event.preventDefault();

            const form = event.target;
            form.classList.add('loading');

            const title = document.getElementById('courseTitle').value;
            const description = document.getElementById('courseDescription').value;
            const category = document.getElementById('courseCategory').value;
            const videoUrl = document.getElementById('courseVideoUrl').value;
            const duration = document.getElementById('courseDuration').value;

            try {
                const { data, error } = await supabase
                    .from('courses')
                    .insert([{
                        title: title,
                        description: description,
                        category: category,
                        video_url: videoUrl,
                        duration: duration,
                        instructor_id: currentUser.id,
                        is_published: false
                    }])
                    .select();

                if (error) throw error;

                showSuccessToast('Course created successfully!');
                form.closest('.modal').remove();
                await loadTeacherDashboard();

            } catch (error) {
                showErrorToast('Error creating course: ' + error.message);
            } finally {
                form.classList.remove('loading');
            }
        }

        async function editCourse(courseId) {
            const { data: course, error } = await supabase
                .from('courses')
                .select('*')
                .eq('id', courseId)
                .single();

            if (error) {
                showErrorToast('Error loading course: ' + error.message);
                return;
            }

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Edit Course</h2>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">✕</button>
                    </div>

                    <form id="editCourseForm" onsubmit="handleEditCourse(event, '${courseId}')">
                        <div class="form-group">
                            <label>Course Title</label>
                            <input type="text" id="editCourseTitle" value="${course.title}" required>
                        </div>

                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="editCourseDescription" rows="3" required>${course.description}</textarea>
                        </div>

                        <div class="form-group">
                            <label>Category</label>
                            <select id="editCourseCategory" required>
                                <option value="Restaurant" ${course.category === 'Restaurant' ? 'selected' : ''}>Restaurant</option>
                                <option value="Retail" ${course.category === 'Retail' ? 'selected' : ''}>Retail</option>
                                <option value="Healthcare" ${course.category === 'Healthcare' ? 'selected' : ''}>Healthcare</option>
                                <option value="Real Estate" ${course.category === 'Real Estate' ? 'selected' : ''}>Real Estate</option>
                                <option value="Other" ${course.category === 'Other' ? 'selected' : ''}>Other</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>YouTube Video URL</label>
                            <input type="url" id="editCourseVideoUrl" value="${course.video_url || ''}" required>
                        </div>

                        <div class="form-group">
                            <label>Duration</label>
                            <input type="text" id="editCourseDuration" value="${course.duration || ''}" placeholder="e.g., 4 hours">
                        </div>

                        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                            <button type="button" class="btn btn-secondary" style="flex: 1;" onclick="this.closest('.modal').remove()">Cancel</button>
                            <button type="submit" class="btn btn-primary" style="flex: 1;">Save Changes</button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
        }

        async function handleEditCourse(event, courseId) {
            event.preventDefault();

            const form = event.target;
            form.classList.add('loading');

            const title = document.getElementById('editCourseTitle').value;
            const description = document.getElementById('editCourseDescription').value;
            const category = document.getElementById('editCourseCategory').value;
            const videoUrl = document.getElementById('editCourseVideoUrl').value;
            const duration = document.getElementById('editCourseDuration').value;

            try {
                const { data, error } = await supabase
                    .from('courses')
                    .update({
                        title: title,
                        description: description,
                        category: category,
                        video_url: videoUrl,
                        duration: duration
                    })
                    .eq('id', courseId);

                if (error) throw error;

                showSuccessToast('Course updated successfully!');
                form.closest('.modal').remove();
                await loadTeacherDashboard();

            } catch (error) {
                showErrorToast('Error updating course: ' + error.message);
            } finally {
                form.classList.remove('loading');
            }
        }

        async function togglePublish(courseId, currentStatus) {
            try {
                const { data, error } = await supabase
                    .from('courses')
                    .update({ is_published: !currentStatus })
                    .eq('id', courseId);

                if (error) throw error;

                showSuccessToast(currentStatus ? 'Course unpublished!' : 'Course published! Students can now see it.');
                await loadTeacherDashboard();

            } catch (error) {
                showErrorToast('Error: ' + error.message);
            }
        }

        // ========================================
        // PDF MANAGEMENT
        // ========================================
        async function managePDFs(courseId) {
            const { data: pdfs, error } = await supabase
                .from('course_pdfs')
                .select('*')
                .eq('course_id', courseId)
                .order('created_at', { ascending: false });

            if (error) {
                console.error('Error loading PDFs:', error);
            }

            const pdfList = pdfs || [];

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Manage Course PDFs</h2>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">✕</button>
                    </div>

                    <div style="margin-bottom: 2rem;">
                        <h3 style="margin-bottom: 1rem;">Upload New PDF</h3>
                        <form id="pdfUploadForm" onsubmit="handlePDFUpload(event, '${courseId}')">
                            <div class="form-group">
                                <label>PDF Title</label>
                                <input type="text" id="pdfTitle" placeholder="e.g., Course Workbook" required>
                            </div>

                            <div class="form-group">
                                <label>Select PDF File</label>
                                <div class="file-input-wrapper">
                                    <input type="file" id="pdfFile" accept=".pdf" required onchange="updateFilePreview(this)">
                                    <div class="file-input-label">
                                        <p style="font-size: 2rem; margin-bottom: 0.5rem;">📄</p>
                                        <p style="color: var(--text-secondary);">Click to select PDF file</p>
                                        <p style="color: var(--text-tertiary); font-size: 0.875rem; margin-top: 0.5rem;">Max size: 50MB</p>
                                    </div>
                                </div>
                                <div id="filePreview" class="file-preview hidden"></div>
                            </div>

                            <button type="submit" class="btn btn-primary" style="width: 100%;">
                                Upload PDF
                            </button>
                        </form>
                    </div>

                    <div style="border-top: 1px solid var(--border-color); padding-top: 2rem;">
                        <h3 style="margin-bottom: 1rem;">Existing PDFs (${pdfList.length})</h3>
                        ${pdfList.length === 0 ? `
                            <p style="color: var(--text-tertiary); text-align: center; padding: 2rem;">
                                No PDFs uploaded yet
                            </p>
                        ` : `
                            <div class="pdf-list">
                                ${pdfList.map(pdf => `
                                    <div class="pdf-item">
                                        <div class="pdf-info">
                                            <span class="pdf-icon">📄</span>
                                            <span>${pdf.title}</span>
                                        </div>
                                        <button class="btn btn-secondary btn-small" onclick="deletePDF('${pdf.id}', '${courseId}')">
                                            Delete
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                        `}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function updateFilePreview(input) {
            const preview = document.getElementById('filePreview');
            if (input.files && input.files[0]) {
                const file = input.files[0];
                preview.innerHTML = `Selected: ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`;
                preview.classList.remove('hidden');
            }
        }

        async function handlePDFUpload(event, courseId) {
            event.preventDefault();

            const form = event.target;
            form.classList.add('loading');

            const title = document.getElementById('pdfTitle').value;
            const fileInput = document.getElementById('pdfFile');
            const file = fileInput.files[0];

            if (!file) {
                showErrorToast('Please select a PDF file');
                form.classList.remove('loading');
                return;
            }

            try {
                const fileExt = file.name.split('.').pop();
                const fileName = `${courseId}/${Date.now()}_${Math.random().toString(36).substring(7)}.${fileExt}`;

                const { data: uploadData, error: uploadError } = await supabase.storage
                    .from('course-pdfs')
                    .upload(fileName, file);

                if (uploadError) throw uploadError;

                const { data: urlData } = supabase.storage
                    .from('course-pdfs')
                    .getPublicUrl(fileName);

                const { data: dbData, error: dbError } = await supabase
                    .from('course_pdfs')
                    .insert([{
                        course_id: courseId,
                        title: title,
                        file_url: urlData.publicUrl,
                        file_path: fileName
                    }]);

                if (dbError) throw dbError;

                showSuccessToast('PDF uploaded successfully!');
                form.closest('.modal').remove();
                managePDFs(courseId);

            } catch (error) {
                showErrorToast('Error uploading PDF: ' + error.message);
            } finally {
                form.classList.remove('loading');
            }
        }

        async function deletePDF(pdfId, courseId) {
            if (!confirm('Are you sure you want to delete this PDF?')) return;

            try {
                const { data: pdf } = await supabase
                    .from('course_pdfs')
                    .select('file_path')
                    .eq('id', pdfId)
                    .single();

                if (pdf && pdf.file_path) {
                    await supabase.storage
                        .from('course-pdfs')
                        .remove([pdf.file_path]);
                }

                const { error } = await supabase
                    .from('course_pdfs')
                    .delete()
                    .eq('id', pdfId);

                if (error) throw error;

                showSuccessToast('PDF deleted successfully!');
                document.querySelector('.modal').remove();
                managePDFs(courseId);

            } catch (error) {
                showErrorToast('Error deleting PDF: ' + error.message);
            }
        }

        // ========================================
        // E-COURSE MANAGEMENT (NEW!)
        // ========================================
        async function manageEcourses(courseId) {
            const { data: ecourses, error } = await supabase
                .from('ecourses')
                .select('*')
                .eq('course_id', courseId)
                .order('created_at', { ascending: false });

            if (error) {
                console.error('Error loading e-courses:', error);
            }

            const ecourseList = ecourses || [];

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Manage E-Courses (Premium Content)</h2>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">✕</button>
                    </div>

                    <div style="margin-bottom: 2rem;">
                        <h3 style="margin-bottom: 1rem;">Upload New E-Course</h3>
                        <form id="ecourseUploadForm" onsubmit="handleEcourseUpload(event, '${courseId}')">
                            <div class="form-group">
                                <label>E-Course Title</label>
                                <input type="text" id="ecourseTitle" placeholder="e.g., Restaurant Marketing Quiz" required>
                            </div>

                            <div class="form-group">
                                <label>Description</label>
                                <textarea id="ecourseDescription" rows="2" placeholder="Brief description of this interactive content..."></textarea>
                            </div>

                            <div class="form-group">
                                <label>Price (USD)</label>
                                <input type="number" id="ecoursePrice" placeholder="9.99" step="0.01" min="0" required>
                            </div>

                            <div class="form-group">
                                <label>Select HTML File (Interactive Quiz/Exercise)</label>
                                <div class="file-input-wrapper">
                                    <input type="file" id="ecourseFile" accept=".html" required onchange="updateEcourseFilePreview(this)">
                                    <div class="file-input-label">
                                        <p style="font-size: 2rem; margin-bottom: 0.5rem;">📝</p>
                                        <p style="color: var(--text-secondary);">Click to select HTML file</p>
                                        <p style="color: var(--text-tertiary); font-size: 0.875rem; margin-top: 0.5rem;">Self-contained HTML files with quizzes/exercises</p>
                                    </div>
                                </div>
                                <div id="ecourseFilePreview" class="file-preview hidden"></div>
                            </div>

                            <button type="submit" class="btn btn-primary" style="width: 100%;">
                                Upload E-Course
                            </button>
                        </form>
                    </div>

                    <div style="border-top: 1px solid var(--border-color); padding-top: 2rem;">
                        <h3 style="margin-bottom: 1rem;">Existing E-Courses (${ecourseList.length})</h3>
                        ${ecourseList.length === 0 ? `
                            <p style="color: var(--text-tertiary); text-align: center; padding: 2rem;">
                                No e-courses uploaded yet
                            </p>
                        ` : `
                            <div class="pdf-list">
                                ${ecourseList.map(ecourse => `
                                    <div class="pdf-item">
                                        <div class="pdf-info">
                                            <span class="pdf-icon">⭐</span>
                                            <div>
                                                <div style="font-weight: 600;">${ecourse.title}</div>
                                                <div style="font-size: 0.875rem; color: var(--text-tertiary);">${ecourse.price} • ${ecourse.is_published ? '✓ Published' : 'Draft'}</div>
                                            </div>
                                        </div>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <button class="btn btn-outline btn-small" onclick="toggleEcoursePublish('${ecourse.id}', ${ecourse.is_published}, '${courseId}')">
                                                ${ecourse.is_published ? 'Unpublish' : 'Publish'}
                                            </button>
                                            <button class="btn btn-secondary btn-small" onclick="deleteEcourse('${ecourse.id}', '${courseId}')">
                                                Delete
                                            </button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        `}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function updateEcourseFilePreview(input) {
            const preview = document.getElementById('ecourseFilePreview');
            if (input.files && input.files[0]) {
                const file = input.files[0];
                preview.innerHTML = `Selected: ${file.name} (${(file.size / 1024).toFixed(2)} KB)`;
                preview.classList.remove('hidden');
            }
        }

        async function handleEcourseUpload(event, courseId) {
            event.preventDefault();

            const form = event.target;
            form.classList.add('loading');

            const title = document.getElementById('ecourseTitle').value;
            const description = document.getElementById('ecourseDescription').value;
            const price = parseFloat(document.getElementById('ecoursePrice').value);
            const fileInput = document.getElementById('ecourseFile');
            const file = fileInput.files[0];

            if (!file) {
                showErrorToast('Please select an HTML file');
                form.classList.remove('loading');
                return;
            }

            try {
                const fileExt = file.name.split('.').pop();
                const fileName = `${courseId}/${Date.now()}_${Math.random().toString(36).substring(7)}.${fileExt}`;

                // Upload with correct content-type for HTML
                const { data: uploadData, error: uploadError } = await supabase.storage
                    .from('ecourse-files')
                    .upload(fileName, file, {
                        contentType: 'text/html',
                        cacheControl: '3600'
                    });

                if (uploadError) throw uploadError;

                const { data: urlData } = supabase.storage
                    .from('ecourse-files')
                    .getPublicUrl(fileName);

                const { data: dbData, error: dbError } = await supabase
                    .from('ecourses')
                    .insert([{
                        course_id: courseId,
                        title: title,
                        description: description,
                        price: price,
                        file_url: urlData.publicUrl,
                        file_path: fileName,
                        is_published: false
                    }]);

                if (dbError) throw dbError;

                showSuccessToast('E-course uploaded successfully!');
                form.closest('.modal').remove();
                manageEcourses(courseId);

            } catch (error) {
                showErrorToast('Error uploading e-course: ' + error.message);
            } finally {
                form.classList.remove('loading');
            }
        }

        async function toggleEcoursePublish(ecourseId, currentStatus, courseId) {
            const newStatus = !currentStatus;
            
            try {
                const { data, error } = await supabase
                    .from('ecourses')
                    .update({ is_published: newStatus })
                    .eq('id', ecourseId)
                    .select();

                if (error) throw error;

                showSuccessToast(newStatus ? 'E-course published! Students can now purchase it.' : 'E-course unpublished!');
                document.querySelector('.modal').remove();
                manageEcourses(courseId);

            } catch (error) {
                showErrorToast('Error: ' + error.message);
                console.error('Publish error:', error);
            }
        }

        async function deleteEcourse(ecourseId, courseId) {
            if (!confirm('Are you sure you want to delete this e-course?')) return;

            try {
                const { data: ecourse } = await supabase
                    .from('ecourses')
                    .select('file_path')
                    .eq('id', ecourseId)
                    .single();

                if (ecourse && ecourse.file_path) {
                    await supabase.storage
                        .from('ecourse-files')
                        .remove([ecourse.file_path]);
                }

                const { error } = await supabase
                    .from('ecourses')
                    .delete()
                    .eq('id', ecourseId);

                if (error) throw error;

                showSuccessToast('E-course deleted successfully!');
                document.querySelector('.modal').remove();
                manageEcourses(courseId);

            } catch (error) {
                showErrorToast('Error deleting e-course: ' + error.message);
            }
        }

        // ========================================
        // STUDENT VIEW COURSE
        // ========================================
        async function viewCourse(courseId) {
            // Mark course as started
            markCourseAsStarted(courseId);
            
            // Track for gamification
            trackCourseView(courseId);

            const { data: course, error } = await supabase
                .from('courses')
                .select('*')
                .eq('id', courseId)
                .single();

            if (error) {
                showErrorToast('Error loading course: ' + error.message);
                return;
            }

            const { data: pdfs } = await supabase
                .from('course_pdfs')
                .select('*')
                .eq('course_id', courseId)
                .order('created_at', { ascending: false });

            const pdfList = pdfs || [];

            let videoId = '';
            if (course.video_url) {
                const urlParams = new URL(course.video_url).searchParams;
                videoId = urlParams.get('v') || course.video_url.split('/').pop();
            }

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>${course.title}</h2>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">✕</button>
                    </div>

                    <p style="color: var(--text-tertiary); margin-bottom: 1rem;">${course.description}</p>
                    
                    <p style="color: var(--text-tertiary); font-size: 0.875rem; margin-bottom: 2rem;">
                        ${course.category}${course.duration ? ' • ' + course.duration : ''}
                    </p>

                    ${videoId ? `
                        <div class="video-container">
                            <iframe 
                                src="https://www.youtube.com/embed/${videoId}" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen>
                            </iframe>
                        </div>
                    ` : '<p style="color: var(--text-tertiary); text-align: center; padding: 2rem;">No video available</p>'}

                    ${pdfList.length > 0 ? `
                        <div style="margin-top: 2rem;">
                            <h3 style="margin-bottom: 1rem;">📄 Course Materials (Free Download)</h3>
                            <div class="pdf-list">
                                ${pdfList.map(pdf => `
                                    <div class="pdf-item">
                                        <div class="pdf-info">
                                            <span class="pdf-icon">📄</span>
                                            <span>${pdf.title}</span>
                                        </div>
                                        <a href="${pdf.file_url}" download target="_blank" class="btn btn-primary btn-small" onclick="trackDownload()">
                                            Download
                                        </a>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}

                    <button class="btn btn-secondary" style="width: 100%; margin-top: 2rem;" onclick="this.closest('.modal').remove()">
                        Close
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Initialize on page load
        init();
    </script>
</body>
</html>